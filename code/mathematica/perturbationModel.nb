(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    133664,       3685]
NotebookOptionsPosition[    126001,       3429]
NotebookOutlinePosition[    126349,       3444]
CellTagsIndexPosition[    126306,       3441]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Setup environment", "Section",
 CellChangeTimes->{{3.7288644375818577`*^9, 3.7288644425881824`*^9}}],

Cell["\<\
Obtains the model for the motion of a probe about a planetary satellite under \
the effect of tidal forces\
\>", "Text",
 CellChangeTimes->{{3.7288665196378164`*^9, 3.728866543822363*^9}, {
  3.7318575265935583`*^9, 3.7318575729591064`*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.731890657397838*^9, 3.7318906761595583`*^9}, 
   3.731891630543618*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7288644443166385`*^9, 3.7288644448503675`*^9}, 
   3.7288645958278637`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$Assumptions", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"_", "\[Element]", "Reals"}], ",", 
    RowBox[{"0", "<", "e", "<", "1"}], ",", 
    RowBox[{"a", ">", "0"}], ",", " ", 
    RowBox[{"\[Mu]", ">", "0"}], ",", " ", 
    RowBox[{
     SubscriptBox["r", "S"], ">", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7318577317048826`*^9, 3.7318577317089057`*^9}, {
  3.7318577848664465`*^9, 3.7318577851306133`*^9}, {3.7319484744801984`*^9, 
  3.731948477566085*^9}, {3.731948529993424*^9, 3.731948531898384*^9}, {
  3.73194856479102*^9, 3.731948568634099*^9}, {3.7319489423508434`*^9, 
  3.73194894471095*^9}, {3.7319499376426125`*^9, 3.731949950167489*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"_", "\[Element]", "Reals"}], ",", 
   RowBox[{"0", "<", "e", "<", "1"}], ",", 
   RowBox[{"a", ">", "0"}], ",", 
   RowBox[{"\[Mu]", ">", "0"}], ",", 
   RowBox[{
    SubscriptBox["r", "S"], ">", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7318582004955244`*^9, {3.7318595285684743`*^9, 3.731859547943184*^9}, 
   3.731859857934517*^9, 3.7318600451570354`*^9, 3.731861030517516*^9, {
   3.731861134364009*^9, 3.731861189205554*^9}, 3.731861219769013*^9, 
   3.731861630932331*^9, {3.731862112050132*^9, 3.7318621217435303`*^9}, 
   3.731862193714309*^9, 3.7318622519915113`*^9, {3.7318623051871047`*^9, 
   3.731862308288912*^9}, {3.731862343208687*^9, 3.7318623635359426`*^9}, {
   3.7318624027206693`*^9, 3.7318624102107735`*^9}, {3.7318625027437973`*^9, 
   3.7318625167714367`*^9}, 3.7318627080613422`*^9, 3.7318628096721926`*^9, {
   3.7318629394309535`*^9, 3.731862952725134*^9}, 3.731862995408434*^9, {
   3.7318630404126644`*^9, 3.731863064297656*^9}, 3.731863102810891*^9, 
   3.731863263925702*^9, 3.7318633283549776`*^9, {3.7318634501782846`*^9, 
   3.7318634619441013`*^9}, {3.7318635692595463`*^9, 
   3.7318635814671593`*^9}, {3.7318637806286726`*^9, 
   3.7318637874247026`*^9}, {3.731864300084918*^9, 3.7318643208995733`*^9}, {
   3.7318660965949535`*^9, 3.731866113670721*^9}, {3.731866415378314*^9, 
   3.7318664596892853`*^9}, 3.7318665732191615`*^9, 3.731866662390648*^9, {
   3.7318667167850237`*^9, 3.731866745236409*^9}, 3.7318668104533887`*^9, 
   3.731866916331259*^9, 3.731866990984662*^9, 3.731867050302849*^9, {
   3.7318671273784423`*^9, 3.7318671528502636`*^9}, {3.731867191783904*^9, 
   3.7318672449746532`*^9}, 3.731867333507896*^9, 3.7318730862508693`*^9, 
   3.7318732188571453`*^9, {3.731873378073227*^9, 3.731873407412453*^9}, {
   3.731873805713982*^9, 3.7318738323767853`*^9}, {3.7318743955721006`*^9, 
   3.731874440263131*^9}, 3.7318748784800215`*^9, {3.7318749456537876`*^9, 
   3.7318749755076866`*^9}, 3.731875194550657*^9, {3.7318755816512856`*^9, 
   3.7318756031677446`*^9}, 3.7318757240856113`*^9, 3.731876127573233*^9, 
   3.7318761735507965`*^9, 3.7318765854180174`*^9, 3.731876657293235*^9, 
   3.7318767366074576`*^9, 3.7318768437555227`*^9, 3.731876934160763*^9, {
   3.731877096913121*^9, 3.7318771144897966`*^9}, 3.7318771692879024`*^9, 
   3.7318772355283813`*^9, 3.7318772727191086`*^9, {3.7318773040278206`*^9, 
   3.73187732612433*^9}, 3.7318775330056124`*^9, 3.7318776643725896`*^9, 
   3.7318777035677605`*^9, {3.731878169665464*^9, 3.731878180108876*^9}, 
   3.7318782329503183`*^9, 3.731878362777804*^9, {3.7318787274804163`*^9, 
   3.7318787485609818`*^9}, 3.731878844447421*^9, 3.7318789584043975`*^9, 
   3.7318790971474004`*^9, 3.731879234823724*^9, 3.73187952470881*^9, 
   3.7318795888662047`*^9, 3.7318802121522007`*^9, 3.7318802489027953`*^9, 
   3.731880282443139*^9, 3.7318803227826586`*^9, 3.7318805055818644`*^9, 
   3.7318810571089535`*^9, 3.7318811338441896`*^9, 3.731881225240099*^9, 
   3.7318814020901628`*^9, {3.731881461785031*^9, 3.731881483061556*^9}, 
   3.731886014853543*^9, 3.731886730985148*^9, 3.731887319346276*^9, 
   3.731887953092106*^9, 3.7318887362127967`*^9, 3.7318890710119443`*^9, {
   3.7318894439323683`*^9, 3.731889468007373*^9}, 3.731889832806355*^9, 
   3.731890373225879*^9, 3.7318907130961723`*^9, 3.7318914475313625`*^9, 
   3.7318915730781617`*^9, 3.731891656002026*^9, 3.7318918108991013`*^9, 
   3.7319278166956882`*^9, 3.7319279669542294`*^9, 3.731938431869847*^9, 
   3.7319410382252827`*^9, 3.7319411283043957`*^9, 3.731941192739487*^9, 
   3.7319412615674486`*^9, 3.7319413825376425`*^9, 3.7319414845110903`*^9, 
   3.731944064169056*^9, 3.7319442894729953`*^9, 3.7319465298116665`*^9, 
   3.7319465962985773`*^9, 3.731946629206682*^9, 3.7319471514391966`*^9, 
   3.7319473257203827`*^9, 3.73194795797892*^9, {3.731948570967656*^9, 
   3.731948576841037*^9}, 3.7319487172510595`*^9, 3.731948947172111*^9, 
   3.7319492727227516`*^9, 3.731949975897313*^9, 3.731951929588862*^9, 
   3.7319528946194353`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"t0", "=", 
   RowBox[{"AbsoluteTime", "[", "]"}]}], ";"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Elliptic motion definitions", "Section",
 CellChangeTimes->{{3.731864601694871*^9, 3.7318646159260798`*^9}}],

Cell["Radius and coordinates in terms of true anomaly f", "Text",
 CellChangeTimes->{{3.731872594195786*^9, 3.7318726074315586`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rF", "=", " ", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"e", "^", "2"}]}], ")"}]}], " ", ")"}], " ", "/", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", " ", 
     RowBox[{"e", " ", 
      RowBox[{"Cos", "[", "f", "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{{3.731864811895719*^9, 3.731864816264406*^9}, {
  3.73194657121369*^9, 3.7319466010898333`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"a", " ", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["e", "2"]}], ")"}]}], 
  RowBox[{"1", "+", 
   RowBox[{"e", " ", 
    RowBox[{"Cos", "[", "f", "]"}]}]}]]], "Output",
 CellChangeTimes->{3.7319466336599517`*^9, 3.7319471514868007`*^9, 
  3.7319473257664795`*^9, 3.7319479580235796`*^9, 3.731948576874547*^9, 
  3.7319487172811327`*^9, 3.7319489472077055`*^9, 3.7319492727598486`*^9, 
  3.7319519296199617`*^9, 3.7319528946565323`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rVecF", "=", 
  RowBox[{"rF", 
   RowBox[{"{", " ", 
    RowBox[{
     RowBox[{"Cos", "[", "f", "]"}], ",", " ", 
     RowBox[{"Sin", "[", "f", "]"}], ",", "0"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.7318661499677896`*^9, 3.731866191302224*^9}, {
  3.731878202878875*^9, 3.731878203068379*^9}, {3.7319464828163123`*^9, 
  3.7319465020382333`*^9}, {3.7319465728612976`*^9, 3.7319466024181848`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", "f", "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{"e", " ", 
      RowBox[{"Cos", "[", "f", "]"}]}]}]], ",", 
   FractionBox[
    RowBox[{"a", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}], ")"}], " ", 
     RowBox[{"Sin", "[", "f", "]"}]}], 
    RowBox[{"1", "+", 
     RowBox[{"e", " ", 
      RowBox[{"Cos", "[", "f", "]"}]}]}]], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.731946633764231*^9, 3.7319471515194106`*^9, 
  3.7319473257945576`*^9, 3.731947958050643*^9, 3.7319485768966074`*^9, 
  3.731948717304699*^9, 3.731948947230215*^9, 3.7319492727854185`*^9, 
  3.7319519296369896`*^9, 3.731952894678592*^9}]
}, Open  ]],

Cell["Radius and coordinates in terms of eccentric anomaly f", "Text",
 CellChangeTimes->{{3.731872610463128*^9, 3.731872622589636*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rE", "=", 
  RowBox[{"a", 
   RowBox[{"(", 
    RowBox[{"1", "-", 
     RowBox[{"e", " ", 
      RowBox[{"Cos", "[", "Ec", "]"}]}]}], ")"}]}]}]], "Input",
 CellChangeTimes->{
  3.731864637348854*^9, {3.7318733887379107`*^9, 3.7318733916076927`*^9}, {
   3.7318813994867473`*^9, 3.731881400088749*^9}, {3.7319465691226325`*^9, 
   3.731946569612936*^9}, 3.7319466038728046`*^9}],

Cell[BoxData[
 RowBox[{"a", " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    RowBox[{"e", " ", 
     RowBox[{"Cos", "[", "Ec", "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.731946633792892*^9, 3.731947151542471*^9, 
  3.7319473258220825`*^9, 3.7319479580757065`*^9, 3.7319485769166603`*^9, 
  3.73194871732572*^9, 3.731948947249264*^9, 3.7319492728059707`*^9, 
  3.73195192965203*^9, 3.7319528947001467`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rVecE", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"a", " ", 
      RowBox[{"Cos", "[", "Ec", "]"}]}], "-", 
     RowBox[{"a", " ", "e"}]}], ",", 
    RowBox[{"a", " ", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "-", 
       RowBox[{"e", "^", "2"}]}], "]"}], " ", 
     RowBox[{"Sin", "[", "Ec", "]"}]}], ",", "0"}], "}"}]}]], "Input",
 CellChangeTimes->{
  3.7318646429732666`*^9, {3.731864760592885*^9, 3.731864889108472*^9}, {
   3.731865164838555*^9, 3.7318651651082153`*^9}, {3.731865447214903*^9, 
   3.731865454945546*^9}, {3.7318656636852584`*^9, 3.731865682974761*^9}, {
   3.7318660674947186`*^9, 3.7318661125521154`*^9}, {3.731873393708622*^9, 
   3.7318733955113816`*^9}, {3.7319464568938847`*^9, 
   3.7319464725264673`*^9}, {3.7319465669288645`*^9, 3.7319465677034297`*^9}, 
   3.731946605308462*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "a"}], " ", "e"}], "+", 
    RowBox[{"a", " ", 
     RowBox[{"Cos", "[", "Ec", "]"}]}]}], ",", 
   RowBox[{"a", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["e", "2"]}]], " ", 
    RowBox[{"Sin", "[", "Ec", "]"}]}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{3.731946633824982*^9, 3.7319471515667467`*^9, 
  3.731947325845647*^9, 3.7319479581028013`*^9, 3.7319485769412246`*^9, 
  3.7319487173473396`*^9, 3.7319489472708225`*^9, 3.7319492728280306`*^9, 
  3.731951929670077*^9, 3.73195289472622*^9}]
}, Open  ]],

Cell["Rotation matrices from perifocal to inertial coordinates:", "Text",
 CellChangeTimes->{{3.731946219860453*^9, 3.731946232585821*^9}, 
   3.73194631234259*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotLambda", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{
     RowBox[{"\[Lambda]", "+", "Pi"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"roti", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"i", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rotomega", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[Omega]", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7319463171638093`*^9, 3.731946348380839*^9}, {
  3.7319479267130938`*^9, 3.7319479275795083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rotPerifocal2Inertial", "=", " ", 
   RowBox[{"rotLambda", ".", "roti", ".", "rotomega"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "rotPerifocal2Inertial", "]"}]}], "Input",
 CellChangeTimes->{{3.7319463627336006`*^9, 3.731946409631687*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], " ", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "i", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "i", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"Sin", "[", "i", "]"}]}], " ", 
       RowBox[{"Sin", "[", "\[Lambda]", "]"}]}]},
     {
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Omega]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "i", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "i", "]"}]}], " ", 
        RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
       RowBox[{"Sin", "[", "i", "]"}]}]},
     {
      RowBox[{
       RowBox[{"Sin", "[", "i", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Omega]", "]"}]}], 
      RowBox[{
       RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
       RowBox[{"Sin", "[", "i", "]"}]}], 
      RowBox[{"Cos", "[", "i", "]"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.731946403713884*^9, 3.7319464110657635`*^9}, {
   3.7319465134159374`*^9, 3.7319465299569283`*^9}, 3.731946596446294*^9, 
   3.7319466338836365`*^9, 3.731947151614874*^9, 3.731947325895779*^9, {
   3.7319479331339126`*^9, 3.7319479581509094`*^9}, 3.731948576976819*^9, 
   3.7319487173854465`*^9, 3.7319489473079214`*^9, 3.731949272868137*^9, 
   3.731951929751296*^9, 3.7319528947728415`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rInertialF", "=", 
  RowBox[{"-", 
   RowBox[{"rotPerifocal2Inertial", ".", "rVecF"}]}]}]], "Input",
 CellChangeTimes->{{3.731947108979665*^9, 3.7319471097280436`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["e", "2"]}], ")"}], " ", 
       RowBox[{"Sin", "[", "f", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "i", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"e", " ", 
        RowBox[{"Cos", "[", "f", "]"}]}]}]]}], "-", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["e", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", "f", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], " ", 
         RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", "i", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"e", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["e", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "f", "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Cos", "[", "\[Omega]", "]"}]}], " ", 
          RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "i", "]"}], " ", 
          RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"e", " ", 
        RowBox[{"Cos", "[", "f", "]"}]}]}]]}], "-", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["e", "2"]}], ")"}], " ", 
      RowBox[{"Sin", "[", "f", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"Cos", "[", "i", "]"}]}], " ", 
         RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"e", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}]}]]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"a", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["e", "2"]}], ")"}], " ", 
       RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
       RowBox[{"Sin", "[", "f", "]"}], " ", 
       RowBox[{"Sin", "[", "i", "]"}]}], 
      RowBox[{"1", "+", 
       RowBox[{"e", " ", 
        RowBox[{"Cos", "[", "f", "]"}]}]}]]}], "-", 
    FractionBox[
     RowBox[{"a", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["e", "2"]}], ")"}], " ", 
      RowBox[{"Cos", "[", "f", "]"}], " ", 
      RowBox[{"Sin", "[", "i", "]"}], " ", 
      RowBox[{"Sin", "[", "\[Omega]", "]"}]}], 
     RowBox[{"1", "+", 
      RowBox[{"e", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{3.731947151646432*^9, 3.731947325929371*^9, 
  3.731947958182995*^9, 3.731948577006575*^9, 3.731948717413023*^9, 
  3.7319489473355236`*^9, 3.7319492728979034`*^9, 3.731951929779398*^9, 
  3.7319528948009167`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rInertialE", "=", 
  RowBox[{"-", 
   RowBox[{"rotPerifocal2Inertial", ".", "rVecE"}]}]}]], "Input",
 CellChangeTimes->{{3.7319471142887077`*^9, 3.731947117375614*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "a"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}]], " ", 
     RowBox[{"Sin", "[", "Ec", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "i", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], " ", "e"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "Ec", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Lambda]", "]"}]}], " ", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "i", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "a"}], " ", "e"}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"Cos", "[", "Ec", "]"}]}]}], ")"}]}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "\[Omega]", "]"}]}], " ", 
        RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "-", 
       RowBox[{
        RowBox[{"Cos", "[", "i", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], "-", 
    RowBox[{"a", " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}]], " ", 
     RowBox[{"Sin", "[", "Ec", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"Cos", "[", "i", "]"}]}], " ", 
        RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "+", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
        RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "a"}], " ", 
     SqrtBox[
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}]], " ", 
     RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
     RowBox[{"Sin", "[", "Ec", "]"}], " ", 
     RowBox[{"Sin", "[", "i", "]"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "a"}], " ", "e"}], "+", 
       RowBox[{"a", " ", 
        RowBox[{"Cos", "[", "Ec", "]"}]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.7319471194625745`*^9, 3.731947151678006*^9, 
  3.731947325965933*^9, 3.731947958223101*^9, 3.7319485770343666`*^9, 
  3.731948717441063*^9, 3.731948947364071*^9, 3.7319492729264884`*^9, 
  3.731951929808445*^9, 3.731952894830997*^9}]
}, Open  ]],

Cell["Anomalies differentials (eqs 13.17 and 13.19)", "Text",
 CellChangeTimes->{{3.731874847412465*^9, 3.7318748547435675`*^9}, {
  3.7318800749133773`*^9, 3.731880091473688*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dtdM", " ", "=", " ", 
   RowBox[{"1", "/", "n"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7318733488719125`*^9, 3.7318733492783346`*^9}, {
   3.7318734103091974`*^9, 3.731873410653281*^9}, 3.7318735439057956`*^9, {
   3.7318735749514265`*^9, 3.73187361536909*^9}, {3.7318738008850384`*^9, 
   3.7318738690993705`*^9}, {3.7318743047979155`*^9, 3.731874438745697*^9}, {
   3.731874518997275*^9, 3.7318746007326794`*^9}, {3.731874668973735*^9, 
   3.731874671266714*^9}, {3.7318747146912775`*^9, 3.731874734161996*^9}, {
   3.7318747788290987`*^9, 3.7318747794114995`*^9}, {3.731874859017881*^9, 
   3.731874876728655*^9}, {3.731874943233231*^9, 3.7318749548670435`*^9}, {
   3.7318800415620065`*^9, 3.7318800986250052`*^9}, {3.7318801364995565`*^9, 
   3.7318801372253876`*^9}, 3.731946536895094*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dMdE", " ", "=", " ", 
   RowBox[{"rE", "/", "a"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7318801392411833`*^9, 3.731880183171838*^9}, 
   3.731946539032776*^9, {3.731947313302007*^9, 3.731947313772865*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dMdf", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"rF", "^", "2"}], "/", 
     RowBox[{"a", "^", "2"}]}], " ", "/", " ", 
    RowBox[{"Sqrt", "[", 
     RowBox[{"1", "-", 
      RowBox[{"e", "^", "2"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.73188019819645*^9, 3.7318802093888865`*^9}, {
   3.73188728866512*^9, 3.7318872937915936`*^9}, 3.731946541099268*^9, {
   3.7319473152365575`*^9, 3.731947315553305*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Obtaining Hill\[CloseCurlyQuote]s Potential for Tidal motion", "Section",
 CellChangeTimes->{{3.731857076722747*^9, 3.7318570957105975`*^9}, {
  3.7319414400055804`*^9, 3.731941443189743*^9}}],

Cell[TextData[{
 "Hill\[CloseCurlyQuote]s problem is the same as RC3BP assuming that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["\[Mu]", 
     RowBox[{"p", "+", "s"}]], "=", 
    SubscriptBox["\[Mu]", "P"]}], TraditionalForm]]],
 ". \[LineSeparator]Problem is nondimensionalized here with distance and \
angular velocity unity."
}], "Text",
 CellChangeTimes->{{3.7318605952878017`*^9, 3.731860645360948*^9}, {
  3.7318606846134453`*^9, 3.731860720239894*^9}, {3.7318790376423388`*^9, 
  3.7318790397052016`*^9}}],

Cell["\<\
We consider a rotating frame where the x axis points from the planet to the \
satellite.\[LineSeparator]Starting from the disturbing potential we obtain an \
approximation about a point far enough on the x axis.\
\>", "Text",
 CellChangeTimes->{{3.731857113597419*^9, 3.7318571455652285`*^9}, {
  3.7318587567593746`*^9, 3.731858787447562*^9}, {3.7318588275321307`*^9, 
  3.7318588431860356`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["rV", "P"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rV", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"x", ",", "y", ",", "z"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   OverscriptBox["rV", "."], "=", 
   RowBox[{"{", 
    RowBox[{
     OverscriptBox["x", "."], ",", 
     OverscriptBox["y", "."], ",", 
     OverscriptBox["z", "."]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7318578388963203`*^9, 3.7318578567589283`*^9}, {
   3.7318579628979445`*^9, 3.7318580266048484`*^9}, {3.731858061333542*^9, 
   3.731858076527562*^9}, 3.7318581967487116`*^9, {3.731859089746505*^9, 
   3.7318590914134417`*^9}, {3.7318594092578897`*^9, 
   3.7318594418297296`*^9}, {3.7318616264717293`*^9, 
   3.7318616285078907`*^9}, {3.731862218617947*^9, 3.7318622501316633`*^9}, {
   3.731862296156143*^9, 3.7318623264405537`*^9}, {3.731862478863971*^9, 
   3.7318624796675367`*^9}, {3.7318636776973114`*^9, 3.731863690239621*^9}, {
   3.7318637279119515`*^9, 3.731863767598897*^9}, {3.731872892394955*^9, 
   3.731872900049384*^9}, {3.731873015693867*^9, 3.7318730304228325`*^9}}],

Cell["The perturbation potential:", "Text",
 CellChangeTimes->{{3.731858293679164*^9, 3.7318583012795115`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[ScriptCapitalR]", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"Abs", "[", 
       SubscriptBox["rV", "p"], "]"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["rV", "P"], ".", "rV"}], ")"}], "/", 
      RowBox[{
       RowBox[{"Abs", "[", 
        RowBox[{
         SubscriptBox["rV", "P"], "+", "rV"}], "]"}], "^", "3"}]}]}], ")"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.73185715860495*^9, 3.731857159358982*^9}, {
   3.731857190792975*^9, 3.731857228884223*^9}, {3.731857414963544*^9, 
   3.7318574844449077`*^9}, {3.7318580363605413`*^9, 
   3.7318580501273117`*^9}, {3.731858093659628*^9, 3.7318581551601562`*^9}, {
   3.731858187267127*^9, 3.7318582051707654`*^9}, {3.731858610844857*^9, 
   3.731858620979871*^9}, 3.731859850809315*^9, {3.731860798596236*^9, 
   3.731860799478692*^9}, 3.731872906368065*^9, {3.7318730335997314`*^9, 
   3.7318730425275235`*^9}}],

Cell[TextData[{
 "For the case of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["r", "P"], TraditionalForm]]],
 ">>r we can expand using Legendre polynomials (see Expansion for the Moon of \
the Sun potential in the notes)."
}], "Text",
 CellChangeTimes->{{3.7318586227508154`*^9, 3.731858642644847*^9}, {
  3.731858716324622*^9, 3.7318587310869346`*^9}, {3.731858845864373*^9, 
  3.73185887024708*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["\[ScriptCapitalR]", "P"], "=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"r", "^", "n"}], " ", 
     RowBox[{"LegendreP", "[", 
      RowBox[{"n", ",", 
       RowBox[{"x", "/", "r"}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"n", ",", "2", ",", "2"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7318592273784213`*^9, 3.731859244235097*^9}, {
   3.7318592993829803`*^9, 3.731859338786686*^9}, {3.7318594454269524`*^9, 
   3.731859446686802*^9}, {3.731859514494219*^9, 3.7318595437811575`*^9}, 
   3.731859849129258*^9, {3.7318600409582143`*^9, 3.731860041096408*^9}, {
   3.7318601457274327`*^9, 3.7318601458384237`*^9}, {3.7318601766021385`*^9, 
   3.7318601766852684`*^9}, {3.7318607924020734`*^9, 
   3.7318607964671974`*^9}, {3.731862043935054*^9, 3.731862057215301*^9}, {
   3.7318621098080587`*^9, 3.7318621182242126`*^9}, {3.7318621621020613`*^9, 
   3.7318621905015335`*^9}, {3.731862240145151*^9, 3.731862245394662*^9}, {
   3.731862341279335*^9, 3.7318623620534725`*^9}, {3.731862483819437*^9, 
   3.7318625007662754`*^9}, {3.7318626877512484`*^9, 
   3.7318626885563593`*^9}, {3.7318628043768597`*^9, 3.731862831228196*^9}, {
   3.731862921859026*^9, 3.731862992072826*^9}, {3.731863051479252*^9, 
   3.731863051959318*^9}, {3.7318631004102845`*^9, 3.7318631013966556`*^9}, {
   3.731864298021375*^9, 3.73186431920361*^9}, {3.7318665096856976`*^9, 
   3.7318665253502216`*^9}, {3.7318665666775317`*^9, 
   3.7318665709298706`*^9}, {3.7318669145367928`*^9, 3.7318669554528093`*^9}, 
   3.7318729231814227`*^9, {3.731873045216795*^9, 3.731873049884959*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     SuperscriptBox["r", "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["x", "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.7318621218468313`*^9, 3.7318621938075314`*^9, 3.7318622520802608`*^9, {
   3.731862305279379*^9, 3.7318623083725185`*^9}, {3.731862343300946*^9, 
   3.731862363615183*^9}, {3.7318624028364058`*^9, 3.7318624102954693`*^9}, {
   3.7318625028422923`*^9, 3.7318625168519373`*^9}, 3.73186270813554*^9, 
   3.731862809759426*^9, {3.731862939525466*^9, 3.7318629528272953`*^9}, 
   3.731862995498764*^9, {3.7318630404983816`*^9, 3.731863064384898*^9}, 
   3.731863102903062*^9, 3.73186326402244*^9, 3.7318633284708443`*^9, {
   3.7318634502755394`*^9, 3.731863462036931*^9}, {3.7318635693640847`*^9, 
   3.7318635815653477`*^9}, {3.731863780735052*^9, 3.7318637875029345`*^9}, {
   3.7318643001828194`*^9, 3.731864320992533*^9}, {3.731866096687047*^9, 
   3.731866113765292*^9}, {3.7318664154576845`*^9, 3.73186645977151*^9}, 
   3.731866573311617*^9, 3.7318666624683228`*^9, {3.731866716867117*^9, 
   3.731866745321168*^9}, 3.73186681054235*^9, 3.731866916426175*^9, 
   3.731867050388068*^9, {3.7318671274598513`*^9, 3.731867152944319*^9}, {
   3.7318671918641167`*^9, 3.7318672450623875`*^9}, 3.731867333591087*^9, 
   3.731873086316554*^9, 3.731873218916298*^9, {3.7318733781454077`*^9, 
   3.7318734074786015`*^9}, {3.731873805783789*^9, 3.731873832437974*^9}, {
   3.731874395641101*^9, 3.731874440333761*^9}, 3.7318748785545707`*^9, {
   3.7318749457299514`*^9, 3.7318749755788507`*^9}, 3.7318751946110735`*^9, {
   3.7318755817204695`*^9, 3.731875603229409*^9}, 3.731875724142762*^9, 
   3.731876127647848*^9, 3.7318761736084733`*^9, 3.731876585479205*^9, 
   3.7318766573614044`*^9, 3.7318767366733217`*^9, 3.731876843830221*^9, 
   3.731876934222545*^9, {3.731877096990066*^9, 3.7318771145494595`*^9}, 
   3.731877169347061*^9, 3.731877235594589*^9, 3.7318772727814665`*^9, {
   3.7318773040994315`*^9, 3.731877326184023*^9}, 3.7318775330908375`*^9, 
   3.731877664515923*^9, 3.7318777036389494`*^9, {3.731878169751204*^9, 
   3.731878180173015*^9}, 3.731878233052637*^9, 3.731878362877067*^9, {
   3.7318787276222906`*^9, 3.7318787487895937`*^9}, 3.7318788445446997`*^9, 
   3.731878958460507*^9, 3.731879097204056*^9, 3.7318792348980017`*^9, 
   3.7318795247724237`*^9, 3.731879588924859*^9, 3.731880212221692*^9, 
   3.7318802489616356`*^9, 3.7318802824998136`*^9, 3.731880322842314*^9, 
   3.7318805056400185`*^9, 3.73188105716835*^9, 3.7318811339018097`*^9, 
   3.73188122530273*^9, 3.7318814021513567`*^9, {3.7318814618461666`*^9, 
   3.7318814831197357`*^9}, 3.7318860149182243`*^9, 3.731886731045755*^9, 
   3.7318873194400587`*^9, 3.731887953208947*^9, 3.7318887362955165`*^9, 
   3.7318890711011815`*^9, {3.7318894441744757`*^9, 3.731889468260047*^9}, 
   3.7318898329031115`*^9, 3.73189037330509*^9, 3.7318907131719046`*^9, 
   3.7318914475872774`*^9, 3.7318915731307907`*^9, 3.731891656085205*^9, 
   3.731891810966274*^9, 3.73192781678292*^9, 3.731927967001075*^9, 
   3.7319384319220724`*^9, 3.731941038277251*^9, 3.7319411283592215`*^9, 
   3.7319411927930336`*^9, 3.731941261626563*^9, 3.7319413825978026`*^9, 
   3.7319414847023687`*^9, 3.7319440643653374`*^9, 3.7319442896735363`*^9, 
   3.7319465300993395`*^9, 3.731946596570483*^9, 3.7319467778984675`*^9, 
   3.731947151794315*^9, 3.7319473260787325`*^9, 3.7319479583406286`*^9, 
   3.7319485771256876`*^9, 3.731948717526825*^9, 3.7319489474477835`*^9, 
   3.7319492730142126`*^9, 3.7319519299678693`*^9, 3.7319528949227405`*^9}]
}, Open  ]],

Cell["Accelerations in the rotating frame:", "Text",
 CellChangeTimes->{{3.7318608220590115`*^9, 3.7318608329253054`*^9}, {
  3.7318609796869354`*^9, 3.7318609835812793`*^9}, {3.7318654107221675`*^9, 
  3.7318654123384485`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"F", "=", 
  RowBox[{
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Mu]", "/", "r"}], "/.", 
      RowBox[{"r", "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "]"}]}]}], ",", " ", "rV"}], "]"}], "+", 
   RowBox[{"Grad", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["\[ScriptCapitalR]", "P"], "/.", 
      RowBox[{"r", "\[Rule]", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"x", "^", "2"}], "+", 
         RowBox[{"z", "^", "2"}], "+", 
         RowBox[{"y", "^", "2"}]}], "]"}]}]}], ",", "rV"}], "]"}], "-", 
   RowBox[{"Cross", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
     RowBox[{"Cross", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", "rV"}], "]"}]}], "]"}],
    "-", 
   RowBox[{"2", 
    RowBox[{"Cross", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
      OverscriptBox["rV", "."]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.731861171649521*^9, 3.7318612163695097`*^9}, {
  3.7318614987529373`*^9, 3.731861501722925*^9}, {3.7318630354799805`*^9, 
  3.7318630587430353`*^9}, {3.7318632418383923`*^9, 3.7318632621258755`*^9}, {
  3.7318633090734367`*^9, 3.731863319032853*^9}, {3.731863448050538*^9, 
  3.7318634482754893`*^9}, {3.731863536357518*^9, 3.7318635791254992`*^9}, {
  3.731863651863686*^9, 3.7318636743852825`*^9}, {3.7318637716564555`*^9, 
  3.73186378601878*^9}, {3.73186664611475*^9, 3.7318666602326117`*^9}, {
  3.7318667135151777`*^9, 3.731866741556487*^9}, {3.731866791787838*^9, 
  3.7318668087106547`*^9}, {3.7318670363435955`*^9, 3.7318670488382163`*^9}, {
  3.731867122528598*^9, 3.7318672434538054`*^9}, {3.7318730522619886`*^9, 
  3.7318730783878803`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"3", " ", "x"}], "-", 
    FractionBox[
     RowBox[{"x", " ", "\[Mu]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]], "+", 
    RowBox[{"2", " ", 
     OverscriptBox["y", "."]}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"y", " ", "\[Mu]"}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["x", "2"], "+", 
         SuperscriptBox["y", "2"], "+", 
         SuperscriptBox["z", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]]]}], "-", 
    RowBox[{"2", " ", 
     OverscriptBox["x", "."]}]}], ",", 
   RowBox[{
    RowBox[{"-", "z"}], "-", 
    FractionBox[
     RowBox[{"z", " ", "\[Mu]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["x", "2"], "+", 
        SuperscriptBox["y", "2"], "+", 
        SuperscriptBox["z", "2"]}], ")"}], 
      RowBox[{"3", "/", "2"}]]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.731866745485633*^9, 3.731866810568885*^9, 3.7318669164537735`*^9, 
   3.7318670504371347`*^9, {3.731867127701964*^9, 3.7318671530354843`*^9}, {
   3.731867191959872*^9, 3.73186724509097*^9}, 3.731867333621176*^9, 
   3.7318730863696566`*^9, 3.731873218936319*^9, {3.731873378170451*^9, 
   3.731873407502593*^9}, {3.7318738058063807`*^9, 3.731873832463543*^9}, {
   3.731874395665193*^9, 3.731874440360818*^9}, 3.731874878583039*^9, {
   3.7318749457525387`*^9, 3.7318749756029606`*^9}, 3.7318751946311455`*^9, {
   3.731875581746033*^9, 3.731875603255478*^9}, 3.7318757241643515`*^9, 
   3.731876127680934*^9, 3.7318761736295366`*^9, 3.731876585502782*^9, 
   3.7318766573889914`*^9, 3.7318767367008944`*^9, 3.7318768438566303`*^9, 
   3.7318769342471066`*^9, {3.731877097016488*^9, 3.7318771145710125`*^9}, 
   3.7318771693706236`*^9, 3.731877235623684*^9, 3.731877272803026*^9, {
   3.7318773041274033`*^9, 3.7318773262060547`*^9}, 3.73187753312142*^9, 
   3.7318776645465045`*^9, 3.731877703665021*^9, {3.731878169783778*^9, 
   3.7318781802000866`*^9}, 3.731878233083703*^9, 3.731878362906142*^9, {
   3.7318787276598577`*^9, 3.731878748859274*^9}, 3.731878844587819*^9, 
   3.7318789584820642`*^9, 3.7318790972251062`*^9, 3.7318792349215903`*^9, 
   3.731879524796466*^9, 3.7318795889456186`*^9, 3.7318802122447433`*^9, 
   3.7318802489846935`*^9, 3.731880282523404*^9, 3.731880322866852*^9, 
   3.7318805056635485`*^9, 3.7318810571924105`*^9, 3.7318811339258738`*^9, 
   3.731881225330325*^9, 3.7318814021733823`*^9, {3.7318814618732367`*^9, 
   3.7318814831432686`*^9}, 3.7318860149452944`*^9, 3.7318867310723476`*^9, 
   3.7318873194711075`*^9, 3.731887953238495*^9, 3.7318887363271303`*^9, 
   3.731889071132264*^9, {3.731889444207059*^9, 3.7318894683427677`*^9}, 
   3.7318898329372325`*^9, 3.7318903733366737`*^9, 3.7318907132511153`*^9, 
   3.7318914476112227`*^9, 3.731891573154359*^9, 3.731891656111158*^9, 
   3.731891810992242*^9, 3.7319278168330545`*^9, 3.7319279670167*^9, 
   3.73193843194112*^9, 3.7319410382973003`*^9, 3.7319411283777685`*^9, 
   3.7319411928120837`*^9, 3.7319412616460843`*^9, 3.7319413826163807`*^9, 
   3.7319414847239237`*^9, 3.731944064386899*^9, 3.7319442896960945`*^9, 
   3.7319465301262465`*^9, 3.7319465965950584`*^9, 3.7319467779247293`*^9, 
   3.7319471518233995`*^9, 3.7319473261058397`*^9, 3.7319479583661995`*^9, 
   3.7319485771466494`*^9, 3.7319487175508995`*^9, 3.731948947468336*^9, 
   3.7319492730337324`*^9, 3.7319519300410633`*^9, 3.731952894946805*^9}]
}, Open  ]]
}, Open  ]],

Cell["Perturbation from the Tidal force", "Section",
 CellChangeTimes->{{3.7318638977273474`*^9, 3.7318639222591677`*^9}, {
  3.73187905135493*^9, 3.7318790519853373`*^9}, {3.73194143060631*^9, 
  3.731941432861968*^9}, {3.7319423660039854`*^9, 3.7319423739449797`*^9}}],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Disturbing Potential", "Subsection"]], "Section",
 CellChangeTimes->{{3.731942428365431*^9, 3.7319424486466026`*^9}}],

Cell["\<\
We use Keplerian elements in a rotating frame. This means that the node \
\[Lambda] will regress with the angular velocity in unperturbed conditions.
\[Lambda]=0 means in it is in the line joining the planet and the satellite, \
this means x is defined opposite to the book.\
\>", "Text",
 CellChangeTimes->{{3.731863982869584*^9, 3.7318639994747324`*^9}, {
  3.7318640394482636`*^9, 3.731864087194434*^9}, {3.7318642487122173`*^9, 
  3.731864258915849*^9}, {3.7319452678005295`*^9, 3.731945299446104*^9}, {
  3.7319453391219616`*^9, 3.7319453524983115`*^9}, {3.731947558407398*^9, 
  3.7319475596295223`*^9}}],

Cell["\<\
We start by expressing the perturbation function in terms of the orbital \
elements.\
\>", "Text",
 CellChangeTimes->{{3.7318643295604506`*^9, 3.7318643565591483`*^9}, {
  3.731879113604695*^9, 3.7318791161634417`*^9}}],

Cell["In terms of true anomaly", "Text",
 CellChangeTimes->{{3.7318791343720493`*^9, 3.731879141010257*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RF", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    SubscriptBox["\[ScriptCapitalR]", "P"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"rInertialF", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"r", "\[Rule]", " ", "rF"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731879219280632*^9, 3.73187922887835*^9}, {
   3.731946761274253*^9, 3.7319467640185113`*^9}, {3.7319468067444286`*^9, 
   3.731946810692981*^9}, {3.731947051570713*^9, 3.731947056118532*^9}, 
   3.7319475545205927`*^9, 3.731947950492877*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      SuperscriptBox["e", "2"]}], ")"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"f", "+", "\[Omega]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "i", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"f", "+", "\[Omega]"}], "]"}]}]}], ")"}], "2"]}]}], 
    ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"e", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}]}], ")"}], "2"]}]]], "Output",
 CellChangeTimes->{
  3.731879240254384*^9, 3.7318795298892217`*^9, 3.73187959280501*^9, 
   3.731880217494934*^9, 3.731880250815087*^9, 3.7318802842753787`*^9, 
   3.7318803277205515`*^9, 3.7318805111431503`*^9, 3.7318810628160257`*^9, 
   3.7318811381599364`*^9, 3.731881229030841*^9, 3.7318814072598515`*^9, {
   3.731881467037056*^9, 3.731881486485916*^9}, 3.731886020494787*^9, 
   3.7318867363430552`*^9, 3.7318873259568834`*^9, {3.731887958534137*^9, 
   3.7318879775476255`*^9}, 3.731888742316668*^9, 3.7318890772981887`*^9, {
   3.7318894507058463`*^9, 3.7318894732107034`*^9}, 3.7318898390654964`*^9, 
   3.7318903789175487`*^9, 3.731890718668639*^9, 3.731891451756761*^9, 
   3.7318915778393164`*^9, 3.7318916609534483`*^9, 3.7318918148175745`*^9, 
   3.731927825688596*^9, 3.7319279704211674`*^9, 3.731938437200451*^9, 
   3.7319410428679423`*^9, 3.731941130751935*^9, 3.7319411951931796`*^9, 
   3.731941266219634*^9, 3.7319413871870985`*^9, 3.731941489133768*^9, 
   3.7319440693442945`*^9, 3.7319442942483587`*^9, 3.731946547767726*^9, 
   3.731946600930937*^9, {3.731946770515271*^9, 3.731946811317069*^9}, 
   3.7319470651157846`*^9, 3.7319471554633737`*^9, 3.731947329872856*^9, 
   3.7319479618025794`*^9, 3.731948582393155*^9, 3.7319487221167555`*^9, 
   3.7319489539018908`*^9, 3.7319492784295835`*^9, 3.7319519336286545`*^9, 
   3.7319528995455275`*^9}]
}, Open  ]],

Cell["\<\
In terms of Eccentric anomaly. These approach is more involved, but more \
straight forward:\
\>", "Text",
 CellChangeTimes->{{3.7318791540683737`*^9, 3.731879163872016*^9}, 
   3.7318792118109727`*^9, {3.7319410044518676`*^9, 3.731941019183632*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RE", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    SubscriptBox["\[ScriptCapitalR]", "P"], "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", 
       RowBox[{"rInertialE", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ",", 
      RowBox[{"r", "\[Rule]", " ", "rE"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7318731241608996`*^9, 3.7318731266403255`*^9}, {
   3.7318731655223265`*^9, 3.7318732053601108`*^9}, 3.7318734058638105`*^9, {
   3.731877996339468*^9, 3.731878005222578*^9}, {3.7318781382270803`*^9, 
   3.7318781781399603`*^9}, {3.731878357179535*^9, 3.7318783614233603`*^9}, {
   3.731878716138229*^9, 3.7318787462684097`*^9}, {3.731878934932085*^9, 
   3.7318789395573807`*^9}, 3.731879147210491*^9, {3.731879213580369*^9, 
   3.731879216083111*^9}, {3.7319471416272345`*^9, 3.7319471458264284`*^9}, 
   3.7319475516875343`*^9, 3.7319479521258783`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["a", "2"]}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"e", " ", 
         RowBox[{"Cos", "[", "Ec", "]"}]}]}], ")"}], "2"]}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", " ", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["e", "2"]}]], " ", 
         RowBox[{"Sin", "[", "Ec", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "i", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
           RowBox[{
            RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}], "+", 
        RowBox[{"a", " ", 
         RowBox[{"(", 
          RowBox[{"e", "-", 
           RowBox[{"Cos", "[", "Ec", "]"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
            RowBox[{"Cos", "[", "\[Omega]", "]"}]}], "-", 
           RowBox[{
            RowBox[{"Cos", "[", "i", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
            RowBox[{"Sin", "[", "\[Omega]", "]"}]}]}], ")"}]}]}], ")"}], 
      "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7318789554306726`*^9, 3.7318789709767265`*^9}, 
   3.731879099277707*^9, 3.731879241564819*^9, 3.7318795425316935`*^9, 
   3.7318795936804123`*^9, 3.731880218877612*^9, 3.7318802516592607`*^9, 
   3.73188028483403*^9, 3.7318803289998164`*^9, 3.7318805242248406`*^9, 
   3.731881076121018*^9, 3.731881139325392*^9, 3.731881229895858*^9, 
   3.731881419493308*^9, {3.731881479544547*^9, 3.731881498109968*^9}, 
   3.7318860334899545`*^9, 3.7318867487382374`*^9, 3.7318873410389423`*^9, 
   3.73188875631535*^9, 3.731889092001279*^9, {3.7318894646900206`*^9, 
   3.731889487354303*^9}, 3.7318898526797256`*^9, 3.7318903928902235`*^9, 
   3.7318907324614058`*^9, 3.7318914560052385`*^9, 3.7318915825575714`*^9, 
   3.7318916735023837`*^9, 3.7318918189793286`*^9, 3.7319278428813004`*^9, 
   3.731927974022233*^9, 3.7319384504877596`*^9, 3.7319410548009434`*^9, 
   3.731941131752276*^9, 3.731941196157079*^9, 3.7319412674859033`*^9, 
   3.731941388467867*^9, 3.7319414904496403`*^9, 3.7319440825092573`*^9, 
   3.7319443079040394`*^9, 3.7319465486761413`*^9, 3.7319466019852123`*^9, 
   3.7319471651952276`*^9, 3.7319473299522934`*^9, 3.73194797194026*^9, 
   3.7319485956806283`*^9, 3.7319487352217226`*^9, 3.731948965879985*^9, 
   3.731949289911919*^9, 3.7319519438056555`*^9, 3.7319529117417436`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Averaging the potential", "Subsection"]], "Section",
 CellChangeTimes->{{3.731875763495922*^9, 3.731875772181467*^9}, {
  3.7318790932625947`*^9, 3.731879095916601*^9}}],

Cell["Averaging the potential for one spacecraft Revolution:", "Text",
 CellChangeTimes->{{3.7318758799840584`*^9, 3.731875914080747*^9}, {
  3.731887635522825*^9, 3.731887636729803*^9}}],

Cell["For eccentric anomaly:", "Text",
 CellChangeTimes->{{3.7318876612536635`*^9, 3.7318876676790667`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"REAvg", " ", "=", 
   RowBox[{"FullSimplify", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"TrigReduce", "[", 
          RowBox[{"RE", " ", "dMdE"}], "]"}], "/.", 
         RowBox[{"Ec", "\[Rule]", " ", "x"}]}], "/.", 
        RowBox[{
         RowBox[{"_", " ", "x"}], "\[Rule]", " ", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"x", "+", " ", "_"}], " ", "\[Rule]", " ", "x"}]}], "/.", 
      RowBox[{
       RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
       RowBox[{"Cos", "[", "x", "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "0"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.731876578333805*^9, 3.731876584316251*^9}, {
   3.7318767104115667`*^9, 3.7318767225923414`*^9}, {3.7318770837413397`*^9, 
   3.731877112891224*^9}, {3.7318771657209187`*^9, 3.731877167986627*^9}, {
   3.731877216818551*^9, 3.731877700226696*^9}, {3.731877775914089*^9, 
   3.7318777981597023`*^9}, {3.7318784507873707`*^9, 3.731878452570135*^9}, {
   3.731878523937504*^9, 3.731878548066761*^9}, {3.7318785947830906`*^9, 
   3.7318785997678275`*^9}, {3.731878708297209*^9, 3.731878708986081*^9}, {
   3.7318793111751986`*^9, 3.7318793329315853`*^9}, {3.7318794964132943`*^9, 
   3.7318795226841116`*^9}, {3.731879582364871*^9, 3.731879584458521*^9}, {
   3.731879624028941*^9, 3.7318796261923027`*^9}, 3.731879660301055*^9, {
   3.73188023245014*^9, 3.73188024138196*^9}, {3.7318802789828463`*^9, 
   3.731880306344457*^9}, {3.731881214808033*^9, 3.7318812195311766`*^9}, {
   3.731881446559881*^9, 3.731881480653058*^9}, {3.7318866341962166`*^9, 
   3.7318866427339954`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "64"], " ", 
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"15", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "i"}], "]"}]}], ")"}], " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Lambda]"}], "]"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "i"}], "]"}]}], "+", 
       RowBox[{"6", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "\[Lambda]"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], ")"}]}], "-", 
    RowBox[{"120", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", "i", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Lambda]"}], "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmVkYGBQA+IF2zwP/z/72vFXvdkvxnOvHS+m6vgzAekDl3hDQbTw
obXzQfSFj7EBzEA67LVVFYgOjVRYDqJnie1aDaItDmnfBNE5545LswDpkhBb
NxCtwS+7EEQ/UL24AUQvkjmxG0RXagadA9EnurRSxYD0nqdNpSA64oXPZGkg
nXR86Q0ZIM2Qt+QhiH58c8NLEJ2TaP8ZRL+aH80kC6QV+BT4QfQxA+tgOSAt
NDsxH0Sf+bu9Qx5I37rP3geiP+goXwXRU+JcX4LoWbdTLRWA9Kk1xzpBdMWH
u7NA9IVj73aA6EObbzwA0Ytu9mkqgdxj0bMYRAMArcqhtQ==
  "]]
}, Open  ]],

Cell["For true anomaly:", "Text",
 CellChangeTimes->{{3.7318876718501635`*^9, 3.731887675187276*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RApreAvg", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"RF", " ", "dMdf"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7318877549208555`*^9, 3.7318878100778446`*^9}, {
  3.731887841354642*^9, 3.731887881970829*^9}, {3.7318879501376677`*^9, 
  3.7318880206251802`*^9}, {3.731889426258191*^9, 3.7318894306897693`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox["a", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["e", "2"]}], ")"}], 
    RowBox[{"7", "/", "2"}]], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"3", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"f", "+", "\[Omega]"}], "]"}]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", "i", "]"}], " ", 
          RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{"f", "+", "\[Omega]"}], "]"}]}]}], ")"}], "2"]}]}], 
    ")"}]}], 
  RowBox[{"2", " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"e", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}]}], ")"}], "4"]}]]], "Output",
 CellChangeTimes->{{3.731887996027244*^9, 3.7318880248614626`*^9}, 
   3.731888588739586*^9, 3.7318887760192785`*^9, 3.7318891098177977`*^9, 
   3.731889505659477*^9, 3.7318898688662996`*^9, 3.731890401630484*^9, 
   3.731890741300085*^9, 3.731891467315499*^9, 3.7318915927382264`*^9, 
   3.731891681295185*^9, 3.7318918286631317`*^9, 3.731927853394188*^9, 
   3.7319279819032354`*^9, 3.731938461817963*^9, 3.7319410636673174`*^9, 
   3.7319411350560594`*^9, 3.7319411994446955`*^9, 3.7319412764627666`*^9, 
   3.731941397315101*^9, 3.731941499499837*^9, 3.731944093024035*^9, 
   3.7319443185354376`*^9, {3.7319465905485535`*^9, 3.7319466106794577`*^9}, 
   3.731947180178321*^9, 3.7319473419069195`*^9, 3.7319479827320642`*^9, 
   3.731948626780941*^9, 3.7319487632158747`*^9, 3.7319490055574427`*^9, 
   3.731949324084566*^9, 3.731951951539214*^9, 3.731952928150481*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rFFourier", " ", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "/", "2"}], ")"}], 
    RowBox[{"FourierCosCoefficient", "[", 
     RowBox[{
      RowBox[{"1", "/", 
       RowBox[{"Denominator", "[", "RApreAvg", "]"}]}], ",", "f", ",", "0", 
      ",", 
      RowBox[{"FourierParameters", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}]}], "+", 
   RowBox[{"Sum", "[", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"FourierCosCoefficient", "[", 
       RowBox[{
        RowBox[{"1", "/", 
         RowBox[{"Denominator", "[", "RApreAvg", "]"}]}], ",", "f", ",", 
        RowBox[{"2", "m"}], ",", 
        RowBox[{"FourierParameters", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}]}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"2", "m", " ", "f"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"m", ",", "1", ",", "1"}], "}"}]}], "]"}], " ", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "First", " ", "term", " ", "is", " ", "divided", " ", "by", " ", "half", 
      " ", "by", " ", "definition"}], ",", " ", 
     RowBox[{
     "in", " ", "the", " ", "book", " ", "only", " ", "even", " ", "powers", 
      " ", "are", " ", "used"}]}], "*)"}]}]}]], "Input",
 CellChangeTimes->{{3.7318853840802794`*^9, 3.73188538408519*^9}, {
   3.731885559116669*^9, 3.731885573548999*^9}, {3.7318856089696646`*^9, 
   3.731885641792487*^9}, {3.7318856917517743`*^9, 3.7318856959248853`*^9}, {
   3.7318857605158186`*^9, 3.731885765376156*^9}, {3.731885874485177*^9, 
   3.731885876346068*^9}, {3.7318859220753965`*^9, 3.7318860003536716`*^9}, {
   3.731886190425234*^9, 3.731886198730328*^9}, {3.7318865618722177`*^9, 
   3.731886580598205*^9}, {3.7318871312749176`*^9, 3.7318871383673954`*^9}, {
   3.731887624219854*^9, 3.7318876311379676`*^9}, 3.731887715011865*^9, {
   3.7318887944675984`*^9, 3.7318888372019176`*^9}, {3.7318888955120945`*^9, 
   3.731888954629633*^9}, {3.7318893713365717`*^9, 3.7318893792279224`*^9}, {
   3.731889417266262*^9, 3.7318894359314184`*^9}, {3.7319382510398245`*^9, 
   3.731938271488765*^9}, {3.73193838100861*^9, 3.7319384084294157`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"1", "+", "e"}]], ")"}], 
     RowBox[{"7", "/", "2"}]], " ", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["e", "2"]}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], 
     RowBox[{"7", "/", "2"}]]}]], "+", 
  FractionBox[
   RowBox[{"5", " ", 
    SuperscriptBox["e", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      FractionBox["1", 
       RowBox[{"1", "+", "e"}]], ")"}], 
     RowBox[{"7", "/", "2"}]], " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", " ", "f"}], "]"}]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", "e"}], ")"}], 
     RowBox[{"7", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{
  3.7318856531663084`*^9, 3.7318857239677224`*^9, 3.7318858508293276`*^9, 
   3.7318861186402626`*^9, 3.7318862391911955`*^9, 3.731886684290431*^9, 
   3.731886796358762*^9, 3.731887148256518*^9, 3.731887317372528*^9, 
   3.731887446493415*^9, 3.7318884130248976`*^9, 3.7318887925943975`*^9, {
   3.7318889412528667`*^9, 3.731888965249404*^9}, 3.731889175387571*^9, {
   3.731889342500258*^9, 3.7318893813528123`*^9}, 3.731889415699967*^9, 
   3.7318895351083345`*^9, 3.7318898792027483`*^9, 3.731890501582034*^9, 
   3.7318908377758417`*^9, 3.7318914933831244`*^9, 3.731891601945021*^9, 
   3.731891774977112*^9, 3.731891854852437*^9, 3.7319279475830617`*^9, 
   3.7319280111930695`*^9, 3.7319383726930065`*^9, 3.7319384079793234`*^9, 
   3.731938487800514*^9, 3.73194107269014*^9, 3.731941143491127*^9, 
   3.731941207905312*^9, 3.73194128476418*^9, 3.7319414054492683`*^9, 
   3.731941508091688*^9, 3.731944155158374*^9, 3.7319443493908863`*^9, {
   3.7319465941760025`*^9, 3.731946610775215*^9}, 3.7319472338565693`*^9, 
   3.7319473816900415`*^9, 3.731947992737612*^9, 3.731948689026498*^9, 
   3.7319487908277173`*^9, 3.731949015674335*^9, 3.731949334059307*^9, 
   3.731952047783757*^9, 3.731952956253699*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RAveraging", "=", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{"rFFourier", " ", 
     RowBox[{"Numerator", "[", "RApreAvg", "]"}]}], " ", "]"}], "/.", 
   RowBox[{
    SqrtBox[
     FractionBox["1", 
      RowBox[{"1", "+", "e"}]]], "\[Rule]", " ", 
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{"1", "+", "e"}], "]"}], " ", 
     RowBox[{"(*", 
      RowBox[{
      "keeps", " ", "failing", " ", "that", " ", "last", " ", "replacement"}],
       "*)"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.7318883855095854`*^9, 3.731888489894821*^9}, {
   3.7318885567545834`*^9, 3.7318886135849266`*^9}, 3.731889440089411*^9, {
   3.731889715590138*^9, 3.731889797417423*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "4"], " ", 
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"2", "+", 
    RowBox[{"3", " ", 
     SuperscriptBox["e", "2"]}], "+", 
    RowBox[{"10", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "f"}], "]"}]}]}], ")"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", 
    RowBox[{"3", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"f", "+", "\[Omega]"}], "]"}]}], "-", 
        RowBox[{
         RowBox[{"Cos", "[", "i", "]"}], " ", 
         RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
         RowBox[{"Sin", "[", 
          RowBox[{"f", "+", "\[Omega]"}], "]"}]}]}], ")"}], "2"]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.7318884161276197`*^9, 3.731888491148652*^9}, 
   3.7318885937865806`*^9, 3.731888638676674*^9, 3.731889189566765*^9, 
   3.7318893209502535`*^9, 3.7318895395822277`*^9, {3.731889764311917*^9, 
   3.7318897799153166`*^9}, 3.7318898833427577`*^9, 3.7318905230871525`*^9, 
   3.731890851719017*^9, 3.7318914969817815`*^9, 3.7318916047088594`*^9, 
   3.7318917860173955`*^9, 3.731891858153118*^9, 3.7319279569087763`*^9, 
   3.731928014024146*^9, 3.7319384916627707`*^9, 3.7319410754037685`*^9, 
   3.731941145771329*^9, 3.731941210263938*^9, 3.7319412874576583`*^9, 
   3.7319414081197615`*^9, 3.731941510856072*^9, 3.7319441678692727`*^9, 
   3.731944353221964*^9, 3.73194661102992*^9, 3.731947243654604*^9, 
   3.7319473857777767`*^9, 3.73194799572093*^9, 3.7319486928488607`*^9, 
   3.731948793200858*^9, 3.731949019491269*^9, 3.731949337628586*^9, 
   3.731952050847903*^9, 3.731952958141368*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{"RFAvg", "=", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"TrigReduce", "[", "RAveraging", "]"}], "/.", 
         RowBox[{"f", "\[Rule]", " ", "x"}]}], "/.", 
        RowBox[{
         RowBox[{"_", " ", "x"}], "\[Rule]", " ", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"x", "+", " ", "_"}], " ", "\[Rule]", " ", "x"}]}], "/.", 
      RowBox[{
       RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
       RowBox[{"Cos", "[", "x", "]"}]}]}], "/.", 
     RowBox[{
      RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "0"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.731880317660509*^9, 3.73188032132402*^9}, {
   3.7318859761858234`*^9, 3.73188601158965*^9}, {3.7318860868396*^9, 
   3.731886093008087*^9}, 3.7318864889467444`*^9, {3.7318866482754507`*^9, 
   3.731886651673962*^9}, 3.7318867202088876`*^9, {3.7318887337784348`*^9, 
   3.7318887342481775`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "128"], " ", 
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{"8", "+", 
    RowBox[{"12", " ", 
     SuperscriptBox["e", "2"]}], "+", 
    RowBox[{"12", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}]}], "-", 
    RowBox[{"6", " ", 
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "i"}], "-", 
       RowBox[{"2", " ", "\[Lambda]"}]}], "]"}]}], "+", 
    RowBox[{"24", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Lambda]"}], "]"}]}], "+", 
    RowBox[{"36", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Lambda]"}], "]"}]}], "-", 
    RowBox[{"12", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Lambda]"}], ")"}]}], "]"}]}], "-", 
    RowBox[{"18", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Lambda]"}], ")"}]}], "]"}]}], "-", 
    RowBox[{"30", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "i"}], "-", 
       RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "+", 
    RowBox[{"15", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "i"}], "-", 
       RowBox[{"2", " ", "\[Lambda]"}], "-", 
       RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "+", 
    RowBox[{"90", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"2", " ", "\[Lambda]"}], "-", 
       RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "-", 
    RowBox[{"60", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"i", "+", 
       RowBox[{"2", " ", "\[Lambda]"}], "-", 
       RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "+", 
    RowBox[{"15", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Lambda]", "-", "\[Omega]"}], ")"}]}], "]"}]}], 
    "+", 
    RowBox[{"60", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}]}], "-", 
    RowBox[{"30", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Omega]"}], ")"}]}], "]"}]}], "+", 
    RowBox[{"15", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"i", "-", "\[Lambda]", "+", "\[Omega]"}], ")"}]}], "]"}]}], 
    "+", 
    RowBox[{"90", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"\[Lambda]", "+", "\[Omega]"}], ")"}]}], "]"}]}], "+", 
    RowBox[{"15", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{"i", "+", "\[Lambda]", "+", "\[Omega]"}], ")"}]}], "]"}]}], 
    "-", 
    RowBox[{"60", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"i", "-", 
       RowBox[{"2", " ", "\[Lambda]"}], "+", 
       RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "+", 
    RowBox[{"60", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"i", "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", "\[Omega]"}], ")"}]}]}], "]"}]}], "+", 
    RowBox[{"60", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"i", "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", "\[Omega]"}], ")"}]}]}], "]"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.731887447700699*^9, 3.7318884556099014`*^9, 
  3.731889196173868*^9, 3.7318895409483595`*^9, 3.7318898845349236`*^9, 
  3.731890529368021*^9, 3.7318908560400085`*^9, 3.731891497925704*^9, 
  3.731891605562512*^9, 3.7318917895096865`*^9, 3.731891858994894*^9, 
  3.731927960477891*^9, 3.73192801486549*^9, 3.7319384925306044`*^9, 
  3.731941076261776*^9, 3.7319411465897584`*^9, 3.7319412110583572`*^9, 
  3.731941287860027*^9, 3.731941408523636*^9, 3.731941511258078*^9, 
  3.7319441717295637`*^9, 3.7319443540807323`*^9, 3.731946612563633*^9, 
  3.7319472509055653`*^9, 3.7319473866796403`*^9, 3.7319479965376472`*^9, 
  3.731948695714697*^9, 3.731948796788082*^9, 3.7319490210048237`*^9, 
  3.7319493390462437`*^9, 3.731952051667081*^9, 3.7319529591410255`*^9}]
}, Open  ]],

Cell["\<\
And averaging for one satellite revolution around the planet (i.e. one cycle \
of lambda)\
\>", "Text",
 CellChangeTimes->{{3.7318891325965366`*^9, 3.7318891613572025`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RAvg2", " ", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"TrigReduce", "[", "REAvg", 
         StyleBox["]",
          FontWeight->"Plain"]}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", " ", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"_", " ", "x"}], "\[Rule]", " ", "x"}]}], "/.", 
      RowBox[{
       RowBox[{"x", "+", " ", "_"}], " ", "\[Rule]", " ", "x"}]}], "/.", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
      RowBox[{"Cos", "[", "x", "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731889308814396*^9, 3.7318893348868227`*^9}, {
  3.731889452895667*^9, 3.731889458970315*^9}, {3.73188956340689*^9, 
  3.7318895848123856`*^9}, {3.73194103477802*^9, 3.7319410364977565`*^9}, {
  3.731941185610396*^9, 3.731941190228527*^9}, {3.7319413656723995`*^9, 
  3.731941366114934*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", 
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"30", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7318895645524025`*^9, 3.731889586439206*^9}, 
   3.7318898853516126`*^9, 3.731890536128728*^9, 3.731890860685923*^9, 
   3.7318914983800335`*^9, 3.7318916059477715`*^9, 3.7318917929383974`*^9, 
   3.7318918594144*^9, 3.7319279633993235`*^9, 3.7319280152292643`*^9, 
   3.731938492898937*^9, 3.73194107662737*^9, 3.7319411469308963`*^9, 
   3.7319412114143033`*^9, 3.7319412882222595`*^9, 3.73194140888184*^9, 
   3.7319415116395917`*^9, 3.731944172205747*^9, 3.731944354413629*^9, 
   3.7319466154505844`*^9, 3.731947251409778*^9, 3.731947387059901*^9, 
   3.731947996922166*^9, 3.731948696209139*^9, 3.731948797315113*^9, 
   3.731949021494624*^9, 3.7319493395312233`*^9, 3.7319520521152725`*^9, 
   3.7319529598950305`*^9}]
}, Open  ]],

Cell["\<\
Which equals the averaging starting from true anomaly(used in the book):\
\>", "Text",
 CellChangeTimes->{{3.731941213045786*^9, 3.731941255799264*^9}, {
  3.731941370255522*^9, 3.7319413781399145`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", " ", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"TrigReduce", "[", "RFAvg", "]"}], "/.", 
       RowBox[{"\[Lambda]", "\[Rule]", " ", "x"}]}], "/.", 
      RowBox[{
       RowBox[{"_", " ", "x"}], "\[Rule]", " ", "x"}]}], "/.", 
     RowBox[{
      RowBox[{"x", "+", " ", "_"}], " ", "\[Rule]", " ", "x"}]}], "/.", 
    RowBox[{
     RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
     RowBox[{"Cos", "[", "x", "]"}]}]}], "/.", 
   RowBox[{
    RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7319412567999363`*^9, 3.7319412593242817`*^9}, {
  3.731941380571479*^9, 3.7319413810545273`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "32"], " ", 
  SuperscriptBox["a", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"2", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       RowBox[{"3", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}]}], "+", 
    RowBox[{"30", " ", 
     SuperscriptBox["e", "2"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.7319412882753716`*^9, 3.7319414089459968`*^9, 
  3.7319415116943064`*^9, 3.7319441760102158`*^9, 3.7319443545289035`*^9, 
  3.731946617527607*^9, 3.7319472593959165`*^9, 3.731947387172905*^9, 
  3.7319479970353575`*^9, 3.731948696277668*^9, 3.7319487973682547`*^9, 
  3.7319490215136766`*^9, 3.7319493395543194`*^9, 3.7319520522087975`*^9, 
  3.731952959951679*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Oblateness potential", "Section",
 CellChangeTimes->{{3.731943025106027*^9, 3.7319430355171323`*^9}, {
  3.7319432284073563`*^9, 3.7319432299090796`*^9}}],

Cell["\<\
We assume tidal locking, the satellite rotation rate equals mean motion. This \
means that is \[Lambda] also the satellite longitude of the ascending node.\
\>", "Text",
 CellChangeTimes->{{3.7319443016037903`*^9, 3.731944346413622*^9}, {
   3.7319447373909383`*^9, 3.731944850899105*^9}, {3.731944995180269*^9, 
   3.7319450458481874`*^9}, 3.7319455203410187`*^9, 3.7319455590412283`*^9}],

Cell["Potential is implemented according to eq 12.15.", "Text",
 CellChangeTimes->{{3.7319455374962797`*^9, 3.7319455563415623`*^9}, {
  3.731947608242981*^9, 3.7319476115295453`*^9}}],

Cell["Potential in terms of true anomaly:", "Text",
 CellChangeTimes->{{3.7319550530319543`*^9, 3.731955067813244*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"sLat", " ", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{"rInertialF", "[", 
     RowBox[{"[", "3", "]"}], "]"}], "/", "rF"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"cLon", " ", "=", " ", 
  RowBox[{"-", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rInertialF", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rInertialF", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"rInertialF", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"sLon", " ", "=", " ", 
  RowBox[{"-", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"rInertialF", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "/", 
     RowBox[{"Sqrt", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"rInertialF", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "^", "2"}], "+", 
       RowBox[{
        RowBox[{"rInertialF", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "^", "2"}]}], "]"}]}], 
    "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7319476130778522`*^9, 3.7319476531502085`*^9}, {
  3.7319482047613997`*^9, 3.7319482363642673`*^9}, {3.7319482933122473`*^9, 
  3.731948358855085*^9}, {3.731948912813257*^9, 3.7319489143085556`*^9}, {
  3.7319491182974625`*^9, 3.731949121035236*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Sin", "[", "i", "]"}]}], " ", 
  RowBox[{"Sin", "[", 
   RowBox[{"f", "+", "\[Omega]"}], "]"}]}]], "Output",
 CellChangeTimes->{
  3.731947997056049*^9, 3.731948184528453*^9, {3.7319482387338967`*^9, 
   3.7319482452151184`*^9}, 3.7319483047530622`*^9, {3.731948337470393*^9, 
   3.7319483603916335`*^9}, 3.7319483966741514`*^9, 3.731948696337327*^9, 
   3.7319487974164076`*^9, 3.7319488447017527`*^9, 3.731948916952325*^9, 
   3.731949021565284*^9, 3.7319493396119184`*^9, 3.7319520522877293`*^9, 
   3.7319529599912844`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"f", "+", "\[Omega]"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"Cos", "[", "i", "]"}], " ", 
       RowBox[{"Sin", "[", "\[Lambda]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"f", "+", "\[Omega]"}], "]"}]}]}], ")"}]}], 
   SqrtBox[
    RowBox[{"3", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"f", "+", "\[Omega]"}], ")"}]}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "i", "]"}], "2"]}]}]]]}]], "Output",
 CellChangeTimes->{
  3.731947997056049*^9, 3.731948184528453*^9, {3.7319482387338967`*^9, 
   3.7319482452151184`*^9}, 3.7319483047530622`*^9, {3.731948337470393*^9, 
   3.7319483603916335`*^9}, 3.7319483966741514`*^9, 3.731948696337327*^9, 
   3.7319487974164076`*^9, 3.7319488447017527`*^9, 3.731948916952325*^9, 
   3.731949021565284*^9, 3.7319493396119184`*^9, 3.7319520522877293`*^9, 
   3.7319529626584883`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{"f", "+", "\[Omega]"}], "]"}], " ", 
       RowBox[{"Sin", "[", "\[Lambda]", "]"}]}], "+", 
      RowBox[{
       RowBox[{"Cos", "[", "i", "]"}], " ", 
       RowBox[{"Cos", "[", "\[Lambda]", "]"}], " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"f", "+", "\[Omega]"}], "]"}]}]}], ")"}]}], 
   SqrtBox[
    RowBox[{"3", "+", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"f", "+", "\[Omega]"}], ")"}]}], "]"}], " ", 
      SuperscriptBox[
       RowBox[{"Sin", "[", "i", "]"}], "2"]}]}]]]}]], "Output",
 CellChangeTimes->{
  3.731947997056049*^9, 3.731948184528453*^9, {3.7319482387338967`*^9, 
   3.7319482452151184`*^9}, 3.7319483047530622`*^9, {3.731948337470393*^9, 
   3.7319483603916335`*^9}, 3.7319483966741514`*^9, 3.731948696337327*^9, 
   3.7319487974164076`*^9, 3.7319488447017527`*^9, 3.731948916952325*^9, 
   3.731949021565284*^9, 3.7319493396119184`*^9, 3.7319520522877293`*^9, 
   3.7319529644442725`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"cmDeltaLon", "[", 
   RowBox[{"m_", ",", "lon0_"}], "]"}], ":=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TrigExpand", "[", 
         RowBox[{"Cos", "[", 
          RowBox[{"m", " ", "l"}], "]"}], "]"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "l", "]"}], "\[Rule]", " ", "cLon"}], " ", ",", 
          RowBox[{
           RowBox[{"Sin", "[", "l", "]"}], "\[Rule]", " ", "sLon"}]}], 
         "}"}]}], ")"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"m", " ", "lon0"}], "]"}]}], " ", "-", " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"TrigExpand", "[", 
         RowBox[{"Sin", "[", 
          RowBox[{"m", " ", "l"}], "]"}], "]"}], "//.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "l", "]"}], "\[Rule]", " ", "cLon"}], " ", ",", 
          RowBox[{
           RowBox[{"Sin", "[", "l", "]"}], "\[Rule]", " ", "sLon"}]}], 
         "}"}]}], " ", ")"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"m", " ", "lon0"}], "]"}]}]}], ",", 
    RowBox[{"TimeConstraint", "\[Rule]", "20"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731949107753312*^9, 3.7319492597914124`*^9}, {
  3.7319494711131*^9, 3.73194950962337*^9}, {3.7319495757398653`*^9, 
  3.7319495761461973`*^9}, {3.7319496493054066`*^9, 3.7319496517171144`*^9}, {
  3.7319497259143243`*^9, 3.7319497729091034`*^9}, {3.7319503004343266`*^9, 
  3.7319503027222767`*^9}, {3.7319505824418316`*^9, 3.731950586555128*^9}, {
  3.731950950171192*^9, 3.731950955327986*^9}, {3.7319523286277943`*^9, 
  3.7319523332169952`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Second", " ", "degree", " ", "only"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ROblatenessF", " ", "=", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"n", "^", "2"}], " ", 
      RowBox[{"a", "^", "3"}], " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "S"], "^", "2"}], "/", 
       RowBox[{"rF", "^", "3"}]}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"2", ",", "0"}], "]"}], 
         RowBox[{"LegendreP", "[", 
          RowBox[{"2", ",", "sLat"}], "]"}]}], "+", 
        RowBox[{
         RowBox[{"J", "[", 
          RowBox[{"2", ",", "2"}], "]"}], 
         RowBox[{"LegendreP", "[", 
          RowBox[{"2", ",", "2", ",", "sLat"}], "]"}], " ", 
         RowBox[{"cmDeltaLon", "[", 
          RowBox[{"2", ",", 
           RowBox[{
            SubscriptBox["\[Lambda]", "0"], "[", 
            RowBox[{"2", ",", "2"}], "]"}]}], "]"}]}]}], ")"}]}], ",", 
     RowBox[{"TimeConstraint", "\[Rule]", "20"}]}], " ", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7319524802333794`*^9, 3.7319525868177443`*^9}, {
  3.731952777431444*^9, 3.7319527797566614`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "-", 
      SuperscriptBox["e", "2"]}], ")"}], "3"]], 
  RowBox[{
   SuperscriptBox["n", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"e", " ", 
       RowBox[{"Cos", "[", "f", "]"}]}]}], ")"}], "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox["3", "4"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", 
          RowBox[{
           SubscriptBox["\[Lambda]", "0"], "[", 
           RowBox[{"2", ",", "2"}], "]"}]}], ")"}]}], "]"}], " ", 
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "2"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"3", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{"f", "+", "\[Omega]"}], ")"}]}], "]"}]}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "i"}], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"f", "+", "\[Omega]"}], "]"}], "2"]}]}], ")"}]}], "+", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "0"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{"f", "+", "\[Omega]"}], "]"}], "2"]}]}], ")"}]}], "-", 
     RowBox[{"3", " ", 
      RowBox[{"Cos", "[", "i", "]"}], " ", 
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "2"}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"f", "+", "\[Omega]"}], ")"}]}], "]"}], " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"\[Lambda]", "+", 
          RowBox[{
           SubscriptBox["\[Lambda]", "0"], "[", 
           RowBox[{"2", ",", "2"}], "]"}]}], ")"}]}], "]"}]}]}], ")"}], " ", 
   SubsuperscriptBox["r", "S", "2"]}]}]], "Output",
 CellChangeTimes->{3.731952582534381*^9, 3.731952637081335*^9, 
  3.7319530340444803`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"General", " ", "function"}], ",", 
    RowBox[{
     RowBox[{"If", " ", "max", " ", "k"}], "=", 
     RowBox[{
     "j", " ", "we", " ", "are", " ", "considering", " ", "sectorial", " ", 
      "and", " ", "tesserial", " ", "harmonics"}]}], ",", " ", 
    RowBox[{"k", "=", 
     RowBox[{"0", " ", "only", " ", "zonals"}]}]}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"ROblatenessF", "=", 
    RowBox[{"FullSimplify", "[", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"n", "^", "2"}], " ", 
       RowBox[{
        RowBox[{"a", "^", "3"}], "/", "rF"}], "  ", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"J", "[", 
           RowBox[{"j", ",", "k"}], "]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SubscriptBox["r", "s"], "/", "rF"}], ")"}], "^", "j"}], " ", 
          RowBox[{"LegendreP", "[", 
           RowBox[{"j", ",", "k", ",", "sLat"}], "]"}], " ", 
          RowBox[{"cmDeltaLon", "[", 
           RowBox[{"k", ",", 
            RowBox[{
             SubscriptBox["\[Lambda]", "0"], "[", 
             RowBox[{"j", ",", "k"}], "]"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"j", ",", "2", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", 
           RowBox[{"{", 
            RowBox[{"0", ",", "2"}], "}"}]}], "}"}]}], "]"}]}], ",", 
      RowBox[{"TimeConstraint", "\[Rule]", "20"}]}], " ", "]"}]}], "*)"}], 
  "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQB2IQLff1h5DcudeOHaliIiD6yMNd+iA6ZeZGYxDNlPbP
EkRn6d60A9EOk1c4gegnPJn+INpFgy8ZRP8I7gbTO1Z4l4PoB1s2VoHoNW5l
dSC6Tsm+AUTfKZw2G0T/0zi8CES/me+6GURLNQSDaQ5ewRvyQFqjpeE2iBYr
T/4EoosusX4G0VNE3n4Dy2+9/h1EbzijxqkAMk/JSwBES+2RvAWiV7wPfwSi
W+SvvwDRbvs5X4LoVSd0tRWB9JWWO2D6yNz9viB64QRtPxB97eeD6SA6ecOh
2SA6i/HoWhA98+PFzSB6TeclDyUg3Rvl4QmiV2gHBIDoS2engemm0vooEP3w
8xQwfe5DUTKIbrbtzgDRAJ4YwQQ=
  "]],

Cell["Averaging for one revolution about the satellite:", "Text",
 CellChangeTimes->{{3.7319551977199545`*^9, 3.7319552151295567`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ROblatenessAvg", " ", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"TrigReduce", "[", 
         RowBox[{"ROblatenessF", " ", "dMdf"}], "]"}], "/.", 
        RowBox[{"f", "\[Rule]", " ", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"_", " ", "x"}], "\[Rule]", " ", "x"}]}], "/.", 
      RowBox[{
       RowBox[{"x", "+", " ", "_"}], " ", "\[Rule]", " ", "x"}]}], "/.", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
      RowBox[{"Cos", "[", "x", "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7319550911598616`*^9, 3.731955103252204*^9}, {
   3.7319551387682037`*^9, 3.731955162168007*^9}, 3.7319552364811015`*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "0"}], "]"}], "+", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}]}], "-", 
      RowBox[{"12", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]", "+", 
           RowBox[{
            SubscriptBox["\[Lambda]", "0"], "[", 
            RowBox[{"2", ",", "2"}], "]"}]}], ")"}]}], "]"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "2"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], ")"}], " ", 
    SubsuperscriptBox["r", "S", "2"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.731955176582864*^9}]
}, Open  ]],

Cell["And one revolution about the planet:", "Text",
 CellChangeTimes->{{3.7319552183355875`*^9, 3.7319552274310465`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ROblatenessAvg2", " ", "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"TrigReduce", "[", "ROblatenessAvg", 
         StyleBox["]",
          FontWeight->"Plain"]}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", " ", "x"}]}], "/.", 
       RowBox[{
        RowBox[{"_", " ", "x"}], "\[Rule]", " ", "x"}]}], "/.", 
      RowBox[{
       RowBox[{"x", "+", " ", "_"}], " ", "\[Rule]", " ", "x"}]}], "/.", 
     RowBox[{
      RowBox[{"Sin", "[", "x", "]"}], "\[Rule]", 
      RowBox[{"Cos", "[", "x", "]"}]}]}], "/.", 
    RowBox[{
     RowBox[{"Cos", "[", "x", "]"}], "\[Rule]", "0"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731955233886984*^9, 3.7319552404437017`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    SuperscriptBox["n", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"J", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    SubsuperscriptBox["r", "S", "2"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["e", "2"]}], ")"}], 
     RowBox[{"3", "/", "2"}]]}]]}]], "Output",
 CellChangeTimes->{3.7319552455956097`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Lagrange Planetary Equations", "Section",
 CellChangeTimes->{{3.731879070006794*^9, 3.731879075243915*^9}, 
   3.7318915596978955`*^9, {3.7319423512796583`*^9, 3.7319423566781034`*^9}, 
   3.73194295531938*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", "=", 
   RowBox[{"RAvg2", "+", "ROblatenessAvg2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7318811130245094`*^9, 3.731881116451922*^9}, 
   3.731881223733617*^9, 3.731889503036004*^9, {3.731955253571375*^9, 
   3.731955253859098*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  OverscriptBox["a", "."], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{"2", "/", 
     RowBox[{"(", 
      RowBox[{"a", " ", "n"}], ")"}]}], 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "Ec"}], "]"}], "/", " ", "dMdE"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731864126103406*^9, 3.7318641396400933`*^9}, {
   3.7318641941027527`*^9, 3.7318642033289785`*^9}, {3.7318749658036857`*^9, 
   3.7318749735112524`*^9}, 3.731875192818988*^9, {3.73188109559683*^9, 
   3.7318811109577847`*^9}, {3.731889635333453*^9, 3.731889669662884*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.731889652495076*^9, 3.7318898853992386`*^9, 
  3.731890536273244*^9, 3.7318908608127317`*^9, 3.7318914984131117`*^9, 
  3.731891606036405*^9, 3.7318917930173626`*^9, 3.7318918594735813`*^9, 
  3.731927963430609*^9, 3.7319280153226633`*^9, 3.731938493887926*^9, 
  3.7319410767050147`*^9, 3.7319411470061398`*^9, 3.731941211501141*^9, 
  3.731941288301972*^9, 3.7319414089740534`*^9, 3.7319415117223897`*^9, 
  3.7319441761197414`*^9, 3.731944354581545*^9, 3.7319466176863203`*^9, 
  3.731947259599489*^9, 3.7319473872481675`*^9, 3.7319479971827707`*^9, 
  3.731948831361722*^9, 3.7319490272375183`*^9, 3.731949346750285*^9, 
  3.731952153106419*^9, 3.7319530341166725`*^9, 3.731955264204718*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  OverscriptBox["e", "."], "=", 
  RowBox[{"FullSimplify", "[", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"e", "^", "2"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], " ", "n", " ", "e"}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"R", ",", "Ec"}], "]"}], " ", "/", " ", "dMdE"}]}], " ", "-", 
    " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"e", "^", "2"}]}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], " ", "n", " ", "e"}], ")"}]}], 
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "\[Omega]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7318750229226003`*^9, 3.731875027308424*^9}, {
   3.731875059522092*^9, 3.7318750657846203`*^9}, {3.7318751270187216`*^9, 
   3.731875190172658*^9}, 3.73188110720619*^9, {3.731889638105711*^9, 
   3.731889639455345*^9}, {3.7318896756492405`*^9, 3.7318896836831083`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", "e", " ", 
   SqrtBox[
    RowBox[{"1", "-", 
     SuperscriptBox["e", "2"]}]], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Omega]"}], "]"}]}], 
  RowBox[{"8", " ", "n"}]]], "Output",
 CellChangeTimes->{3.7318896849714913`*^9, 3.7318898856218295`*^9, 
  3.731890536648*^9, 3.7318908610488887`*^9, 3.7318914986106367`*^9, 
  3.7318916062364635`*^9, 3.7318917932284203`*^9, 3.731891859658045*^9, 
  3.7319279636181326`*^9, 3.731928015498234*^9, 3.731938494082942*^9, 
  3.731941076887*^9, 3.7319411471825657`*^9, 3.731941211741827*^9, 
  3.731941288476406*^9, 3.731941409151029*^9, 3.7319415119009104`*^9, 
  3.731944176317753*^9, 3.731944354760575*^9, 3.7319466181876802`*^9, 
  3.731947259893754*^9, 3.7319473874416466`*^9, 3.7319479973733053`*^9, 
  3.7319488315752897`*^9, 3.731949027462117*^9, 3.731949346954842*^9, 
  3.731952153527672*^9, 3.7319530343353786`*^9, 3.7319552645195713`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  OverscriptBox["M", "."], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"n", "-", 
      RowBox[{
       RowBox[{"2", "/", 
        RowBox[{"(", 
         RowBox[{"a", " ", "n"}], ")"}]}], " ", 
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "a"}], "]"}]}], "-", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"e", "^", "2"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"a", "^", "2"}], " ", "n", " ", "e"}], ")"}]}], " ", 
       RowBox[{"D", "[", 
        RowBox[{"R", ",", "e"}], "]"}]}]}], "]"}], ",", "n"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7318751997793827`*^9, 3.731875262476778*^9}, {
   3.7318753006812468`*^9, 3.7318753418596163`*^9}, 3.7318896420430593`*^9, {
   3.7318898060766487`*^9, 3.731889810073269*^9}, {3.7319419472706537`*^9, 
   3.731941957527011*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox["7", "16"]}], "-", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["e", "2"]}], "16"], "-", 
    RowBox[{
     FractionBox["3", "16"], " ", 
     RowBox[{"(", 
      RowBox[{"7", "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["15", "8"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", 
       SuperscriptBox["e", "2"]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], "n"], "+", 
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"3", " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}], " ", 
       SubsuperscriptBox["r", "S", "2"]}], 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["e", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.7318896525587482`*^9, 3.7318898865462894`*^9, 
  3.7318905462972584`*^9, 3.731890867689109*^9, 3.731891499221504*^9, 
  3.7318916068741617`*^9, 3.7318917986041*^9, 3.7318918602643642`*^9, 
  3.7319279644306827`*^9, 3.7319280161162176`*^9, 3.731938494764183*^9, 
  3.731941077516778*^9, 3.7319411477927012`*^9, 3.731941212358968*^9, 
  3.7319412891611843`*^9, 3.731941409838107*^9, 3.731941512633391*^9, 
  3.731941964656723*^9, 3.7319441769595337`*^9, 3.7319443553591623`*^9, 
  3.7319466214490967`*^9, 3.731947260286787*^9, 3.7319473880833826`*^9, 
  3.731947997998926*^9, 3.731948832451802*^9, 3.731949028276713*^9, 
  3.731949347696314*^9, 3.7319521543714695`*^9, 3.7319530350884647`*^9, 
  3.7319552679873743`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[Lambda]", "."], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"1", "/", 
      RowBox[{"(", 
       RowBox[{"n", " ", 
        RowBox[{"a", "^", "2"}], " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"e", "^", "2"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", "i", "]"}]}], ")"}]}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "i"}], "]"}]}], "-", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7318753853798523`*^9, 3.7318755172462645`*^9}, 
   3.7318755991825767`*^9, 3.731875684180625*^9, 3.7318896435015316`*^9, {
   3.731889815699418*^9, 3.731889818802635*^9}, {3.731891436049556*^9, 
   3.731891438186736*^9}, {3.7318916400698204`*^9, 3.731891643685938*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "1"}], "-", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"Cos", "[", "i", "]"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["a", "2"]}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["e", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "-", 
         RowBox[{"3", " ", 
          SuperscriptBox["e", "2"]}], "+", 
         RowBox[{"5", " ", 
          SuperscriptBox["e", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["n", "2"], " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}], " ", 
       SubsuperscriptBox["r", "S", "2"]}]}], ")"}]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["a", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["e", "2"]}], ")"}], "2"], " ", "n"}]]}]], "Output",
 CellChangeTimes->{3.73188965259334*^9, 3.731889887216568*^9, 
  3.7318907019581413`*^9, 3.7318914436237755`*^9, 3.7318914992653637`*^9, 
  3.7318916068981953`*^9, 3.7318918074440413`*^9, 3.731891860795714*^9, 
  3.7319280166006055`*^9, 3.7319384953191905`*^9, 3.73194107807541*^9, 
  3.731941148350689*^9, 3.7319412129234667`*^9, 3.731941289716157*^9, 
  3.7319414103910217`*^9, 3.731941513228473*^9, 3.731944177518978*^9, 
  3.7319443559050817`*^9, 3.731947261188181*^9, 3.7319473887312317`*^9, 
  3.7319479986877565`*^9, 3.731948833097515*^9, 3.731949028947095*^9, 
  3.731949348348768*^9, 3.731952155151853*^9, 3.7319530357301702`*^9, 
  3.7319552700643744`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"didt", " ", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", "1"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", " ", 
        RowBox[{"a", "^", "2"}], " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"e", "^", "2"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", "i", "]"}]}], ")"}]}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "\[Lambda]"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Cos", "[", "i", "]"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], " ", "n", " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"e", "^", "2"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", "i", "]"}]}], ")"}]}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "\[Omega]"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.731889645525453*^9, {3.7318898226646214`*^9, 3.731889825113099*^9}, {
   3.731889990702895*^9, 3.7318900430536194`*^9}, {3.731939200031004*^9, 
   3.7319392023183155`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox["e", "2"], " ", 
    RowBox[{"Cos", "[", "i", "]"}], " ", 
    RowBox[{"Cos", "[", "\[Omega]", "]"}], " ", 
    RowBox[{"Sin", "[", "i", "]"}], " ", 
    RowBox[{"Sin", "[", "\[Omega]", "]"}]}], 
   RowBox[{"4", " ", 
    SqrtBox[
     RowBox[{"1", "-", 
      SuperscriptBox["e", "2"]}]], " ", "n"}]]}]], "Output",
 CellChangeTimes->{
  3.731889652620411*^9, 3.7318898874115887`*^9, {3.731889996824011*^9, 
   3.7318900204353194`*^9}, 3.7318900515268793`*^9, 3.731891499370102*^9, 
   3.7318916070035095`*^9, 3.73189186092236*^9, 3.731928016773489*^9, 
   3.7319384954813576`*^9, 3.7319392060954*^9, 3.731941078270842*^9, 
   3.7319411485367136`*^9, 3.731941213121519*^9, 3.7319412899101863`*^9, 
   3.731941410581529*^9, 3.7319415134360743`*^9, 3.7319441777085123`*^9, 
   3.731944356091069*^9, 3.731947261717574*^9, 3.731947388872107*^9, 
   3.73194799883111*^9, 3.7319488332920322`*^9, 3.731949029083433*^9, 
   3.731949348497164*^9, 3.73195215536091*^9, 3.731953035879567*^9, 
   3.731955270277429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  OverscriptBox["\[Omega]", "."], "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Sqrt", "[", 
       RowBox[{"1", "-", 
        RowBox[{"e", "^", "2"}]}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"a", "^", "2"}], " ", "n", " ", "e"}], ")"}]}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "e"}], "]"}]}], " ", "-", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "i", "]"}], "/", 
      RowBox[{"(", 
       RowBox[{"n", " ", 
        RowBox[{"a", "^", "2"}], " ", 
        RowBox[{"Sqrt", "[", 
         RowBox[{"1", "-", 
          RowBox[{"e", "^", "2"}]}], "]"}], " ", 
        RowBox[{"Sin", "[", "i", "]"}]}], ")"}]}], " ", 
     RowBox[{"D", "[", 
      RowBox[{"R", ",", "i"}], "]"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731875522785266*^9, 3.731875584880672*^9}, 
   3.7318760557126827`*^9, 3.7318761329440107`*^9, 3.7318896467218904`*^9, {
   3.7318898273484917`*^9, 3.7318898308408613`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", 
   RowBox[{"16", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"a", "-", 
       RowBox[{"a", " ", 
        SuperscriptBox["e", "2"]}]}], ")"}], "2"], " ", "n"}]], 
  RowBox[{"3", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "2"]}], " ", 
      SuperscriptBox["a", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["e", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         RowBox[{"(", 
          RowBox[{"3", "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["e", "2"]}], "+", 
           RowBox[{"5", " ", 
            RowBox[{"Cos", "[", 
             RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}]}], "+", 
        RowBox[{"10", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["e", "2"]}], "+", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "i"}], "]"}]}], ")"}], " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "\[Omega]"}], "]"}]}]}], ")"}]}], "-", 
     RowBox[{"2", " ", 
      SuperscriptBox["n", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"3", "+", 
        RowBox[{"5", " ", 
         RowBox[{"Cos", "[", 
          RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "0"}], "]"}], " ", 
      SubsuperscriptBox["r", "S", "2"]}]}], ")"}]}]}]], "Output",
 CellChangeTimes->{3.731889652659013*^9, 3.7318898881571054`*^9, 
  3.7318914999124107`*^9, 3.731891607635398*^9, 3.731891861509412*^9, 
  3.7319280173609076`*^9, 3.731938496152446*^9, 3.7319410789249277`*^9, 
  3.731941149171377*^9, 3.73194121381132*^9, 3.731941290560484*^9, 
  3.7319414112158813`*^9, 3.7319415141333375`*^9, 3.7319441783356495`*^9, 
  3.7319443566290255`*^9, 3.731947262587003*^9, 3.7319473895546556`*^9, 
  3.731947999544295*^9, 3.7319488340716133`*^9, 3.7319490297484927`*^9, 
  3.731949349185342*^9, 3.7319521561795845`*^9, 3.7319530368952694`*^9, 
  3.7319552742645283`*^9}]
}, Open  ]],

Cell["\<\
These have been verified to match the book for identical considerations.\
\>", "Text",
 CellChangeTimes->{{3.7319408983154764`*^9, 3.7319409290017076`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["Equations for Small Eccentricity", "Subsection"]], \
"Section",
 CellChangeTimes->{{3.7319415954046345`*^9, 3.7319416127458973`*^9}, {
  3.7319416467950773`*^9, 3.731941656694558*^9}}],

Cell["This assumption follows from the analysis of a low orbiter:", "Text",
 CellChangeTimes->{{3.7319422014844065`*^9, 3.731942228983048*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   OverscriptBox["a", "."], "E"], "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    OverscriptBox["a", "."], ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731941684111972*^9, 3.7319416862090187`*^9}, {
  3.731941732914219*^9, 3.7319417333806486`*^9}, {3.7319418014354563`*^9, 
  3.731941844721414*^9}, {3.7319418781510906`*^9, 3.731941880938611*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.731941881432556*^9, 3.7319441783527203`*^9, 
  3.7319443566480837`*^9, 3.731947262657692*^9, 3.7319473896498766`*^9, 
  3.731947999639115*^9, 3.7319488340926604`*^9, 3.73194902982617*^9, 
  3.731949349267052*^9, 3.7319521562166815`*^9, 3.731953036939387*^9, 
  3.731955274343794*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   OverscriptBox["e", "."], "E"], "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    OverscriptBox["e", "."], ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731941899675115*^9, 3.7319419017975845`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   FractionBox[
    RowBox[{"15", " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}], " ", "e"}], 
    RowBox[{"8", " ", "n"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "e", "]"}], "2"],
    SeriesData[$CellContext`e, 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`e, 0, {
   Rational[15, 8] $CellContext`n^(-1) Sin[$CellContext`i]^2 
    Sin[2 $CellContext`\[Omega]]}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.7319419050788803`*^9, 3.731944178370818*^9, 
  3.7319443566661267`*^9, 3.7319472626842613`*^9, 3.7319473896784525`*^9, 
  3.73194799966835*^9, 3.731948834118229*^9, 3.731949029844246*^9, 
  3.7319493492871337`*^9, 3.7319521562948914`*^9, 3.731953036957935*^9, 
  3.7319552743637924`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   OverscriptBox["M", "."], "E"], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      OverscriptBox["M", "."], ",", 
      RowBox[{"{", 
       RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", "n"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.731941928603997*^9, 3.731941935118485*^9}, {
  3.7319419743781476`*^9, 3.731941980302347*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox["7", "16"]}], "-", 
    RowBox[{
     FractionBox["21", "16"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}]}], "-", 
    RowBox[{
     FractionBox["15", "8"], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "i", "]"}], "2"]}]}], "n"], "+", 
  RowBox[{"n", " ", 
   RowBox[{"(", 
    RowBox[{"1", "+", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}], " ", 
       SubsuperscriptBox["r", "S", "2"]}], 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      RowBox[{"9", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}], " ", 
       SubsuperscriptBox["r", "S", "2"]}], 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{
  3.7319419371207333`*^9, {3.7319419693412714`*^9, 3.7319419808450036`*^9}, 
   3.731944178427437*^9, 3.7319443567169323`*^9, 3.731947262712837*^9, 
   3.731947389758693*^9, 3.731947999740596*^9, 3.731948834280135*^9, 
   3.7319490299229245`*^9, 3.731949349347766*^9, 3.731952156381118*^9, 
   3.7319530370446663`*^9, 3.7319552744881306`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   OverscriptBox["\[Lambda]", "."], "E"], "=", 
  RowBox[{"Series", "[", 
   RowBox[{
    OverscriptBox["\[Lambda]", "."], ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731941989822361*^9, 3.7319420032874885`*^9}, 
   3.7319420434915648`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "-", 
     FractionBox[
      RowBox[{"3", " ", 
       RowBox[{"Cos", "[", "i", "]"}]}], 
      RowBox[{"4", " ", "n"}]], "+", 
     FractionBox[
      RowBox[{"3", " ", "n", " ", 
       RowBox[{"Cos", "[", "i", "]"}], " ", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}], " ", 
       SubsuperscriptBox["r", "S", "2"]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "e", "]"}], "2"],
    SeriesData[$CellContext`e, 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`e, 
   0, {-1 + Rational[-3, 4] $CellContext`n^(-1) Cos[$CellContext`i] + 
    Rational[3, 2] $CellContext`a^(-2) $CellContext`n 
     Cos[$CellContext`i] $CellContext`J[2, 0] 
     Subscript[$CellContext`r, $CellContext`S]^2}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.7319420055108185`*^9, 3.731944178446518*^9, 
  3.731944356737487*^9, 3.731947262737403*^9, 3.731947389785738*^9, 
  3.7319479997662*^9, 3.7319488343392925`*^9, 3.7319490299725556`*^9, 
  3.7319493493708267`*^9, 3.7319521564593325`*^9, 3.7319530370712376`*^9, 
  3.7319552745713778`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["didt", "E"], "=", 
  RowBox[{"Series", "[", 
   RowBox[{"didt", ",", 
    RowBox[{"{", 
     RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731942031189898*^9, 3.7319420381125326`*^9}}],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "e", "]"}], "2"],
  SeriesData[$CellContext`e, 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.731942039042176*^9, 3.7319441784660144`*^9, 
  3.7319443567570395`*^9, 3.731947262761978*^9, 3.7319473898128514`*^9, 
  3.731947999793111*^9, 3.731948834362856*^9, 3.73194902999261*^9, 
  3.731949349391884*^9, 3.7319521564833913`*^9, 3.731953037089286*^9, 
  3.7319552745904217`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox[
   OverscriptBox["\[Omega]", "."], "E"], "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       OverscriptBox["\[Omega]", "."], ",", 
       RowBox[{"{", 
        RowBox[{"e", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], ",", 
    RowBox[{"J", "[", 
     RowBox[{"2", ",", "0"}], "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.731942052382072*^9, 3.7319420641941605`*^9}, {
  3.73195529273412*^9, 3.731955312675871*^9}, {3.731955525671648*^9, 
  3.7319555494704103`*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Omega]"}], "]"}]}], "+", 
      RowBox[{"10", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "\[Omega]", "]"}], "2"]}]}], ")"}]}], 
   RowBox[{"16", " ", "n"}]], "-", 
  FractionBox[
   RowBox[{"3", " ", "n", " ", 
    RowBox[{"(", 
     RowBox[{"3", "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"J", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    SubsuperscriptBox["r", "S", "2"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["a", "2"]}]]}]], "Output",
 CellChangeTimes->{
  3.7319420652526236`*^9, 3.731944178527692*^9, 3.731944356781179*^9, 
   3.7319472628914967`*^9, 3.7319473898403826`*^9, 3.731947999817164*^9, 
   3.731948834425521*^9, 3.731949030048258*^9, 3.7319493494139423`*^9, 
   3.731952156564608*^9, 3.7319530371263847`*^9, 3.7319552746852336`*^9, {
   3.7319553091450605`*^9, 3.7319553132444053`*^9}, {3.7319555309462175`*^9, 
   3.7319555505663395`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analysis of the Motion", "Section",
 CellChangeTimes->{{3.7319420899398975`*^9, 3.731942101932431*^9}}],

Cell["\<\
We have found the EOMs, we now investigate the behavior of the motion. Only \
the equations for \[Omega] and e are relevant. All others are either \
ignorable or constant.\
\>", "Text",
 CellChangeTimes->{{3.7319421273370457`*^9, 3.73194214426648*^9}, {
  3.7319422528742332`*^9, 3.7319422907444053`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eDot", "=", 
  RowBox[{"Normal", "[", 
   SubscriptBox[
    OverscriptBox["e", "."], "E"], "]"}]}]], "Input",
 CellChangeTimes->{{3.7319576856753674`*^9, 3.7319576910785103`*^9}, {
  3.731963957720053*^9, 3.7319639610840034`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Omega]"}], "]"}]}], 
  RowBox[{"8", " ", "n"}]]], "Output",
 CellChangeTimes->{{3.7319576823700438`*^9, 3.7319576916424894`*^9}, 
   3.731958363875671*^9, 3.731963961977885*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]Dot", " ", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"TrigExpand", "[", 
      SubscriptBox[
       OverscriptBox["\[Omega]", "."], "E"], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[Omega]", "]"}], "^", "2"}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", "\[Omega]", "]"}], "^", "2"}], ",", 
       RowBox[{"J", "[", 
        RowBox[{"2", ",", "0"}], "]"}]}], "}"}]}], "]"}], "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Cos", "[", "\[Omega]", "]"}], "^", "2"}], "-", 
      RowBox[{
       RowBox[{"Sin", "[", "\[Omega]", "]"}], "^", "2"}]}], ")"}], "\[Rule]", 
    " ", 
    RowBox[{"Cos", "[", 
     RowBox[{"2", "\[Omega]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.7319573958257523`*^9, 3.7319573962559032`*^9}, {
  3.731957540273325*^9, 3.7319575472371435`*^9}, {3.7319576579111347`*^9, 
  3.731957667962472*^9}, {3.7319582943775845`*^9, 3.7319583126246157`*^9}, {
  3.731958345964964*^9, 3.7319583572259274`*^9}, {3.7319639658557515`*^9, 
  3.731964193240943*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["9", 
   RowBox[{"16", " ", "n"}]], "+", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox[
     RowBox[{"Cos", "[", "i", "]"}], "2"]}], 
   RowBox[{"16", " ", "n"}]], "-", 
  FractionBox[
   RowBox[{"15", " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "i", "]"}], "2"]}], 
   RowBox[{"16", " ", "n"}]], "+", 
  RowBox[{
   SuperscriptBox[
    RowBox[{"Cos", "[", "\[Omega]", "]"}], "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox["15", 
      RowBox[{"16", " ", "n"}]], "-", 
     FractionBox[
      RowBox[{"15", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "i", "]"}], "2"]}], 
      RowBox[{"16", " ", "n"}]], "+", 
     FractionBox[
      RowBox[{"15", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "i", "]"}], "2"]}], 
      RowBox[{"16", " ", "n"}]]}], ")"}]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["15", 
       RowBox[{"16", " ", "n"}]]}], "+", 
     FractionBox[
      RowBox[{"15", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "i", "]"}], "2"]}], 
      RowBox[{"16", " ", "n"}]], "-", 
     FractionBox[
      RowBox[{"15", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "i", "]"}], "2"]}], 
      RowBox[{"16", " ", "n"}]]}], ")"}], " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "\[Omega]", "]"}], "2"]}], "+", 
  RowBox[{
   RowBox[{"J", "[", 
    RowBox[{"2", ",", "0"}], "]"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"9", " ", "n", " ", 
        SubsuperscriptBox["r", "S", "2"]}], 
       RowBox[{"8", " ", 
        SuperscriptBox["a", "2"]}]]}], "-", 
     FractionBox[
      RowBox[{"15", " ", "n", " ", 
       SuperscriptBox[
        RowBox[{"Cos", "[", "i", "]"}], "2"], " ", 
       SubsuperscriptBox["r", "S", "2"]}], 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"]}]], "+", 
     FractionBox[
      RowBox[{"15", " ", "n", " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
       SubsuperscriptBox["r", "S", "2"]}], 
      RowBox[{"8", " ", 
       SuperscriptBox["a", "2"]}]]}], ")"}]}]}]], "Output",
 CellChangeTimes->{{3.731958358461598*^9, 3.7319583639684525`*^9}, 
   3.731964019985897*^9, {3.7319640730803595`*^9, 3.7319641938907614`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[Omega]Dot", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"(", 
      RowBox[{"16", "n"}], ")"}]}], 
    RowBox[{"(", 
     RowBox[{"9", "-", 
      RowBox[{"15", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "i"}], "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"15", "-", 
         RowBox[{"15", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", "i"}], "]"}]}]}], ")"}], 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "\[Omega]"}], "]"}]}]}], ")"}]}], "+", 
   RowBox[{"n", " ", 
    RowBox[{"J", "[", 
     RowBox[{"2", ",", "0"}], "]"}], 
    RowBox[{
     RowBox[{
      SubscriptBox["r", "S"], "^", "2"}], " ", "/", " ", 
     RowBox[{"a", "^", "2"}]}], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "9"}], "/", "8"}], "-", 
      RowBox[{
       RowBox[{"15", "/", "8"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", "i"}], "]"}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.731964241028345*^9, 3.7319644123417535`*^9}, 
   3.73196444859837*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"9", "-", 
    RowBox[{"15", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"15", "-", 
       RowBox[{"15", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}]}]}], 
   RowBox[{"16", " ", "n"}]], "+", 
  FractionBox[
   RowBox[{"n", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["9", "8"]}], "-", 
      RowBox[{
       FractionBox["15", "8"], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
    RowBox[{"J", "[", 
     RowBox[{"2", ",", "0"}], "]"}], " ", 
    SubsuperscriptBox["r", "S", "2"]}], 
   SuperscriptBox["a", "2"]]}]], "Output",
 CellChangeTimes->{3.731964449259223*^9}]
}, Open  ]],

Cell["Replace with parameters:", "Text",
 CellChangeTimes->{{3.731957549132489*^9, 3.731957556114688*^9}, {
  3.7319575983273745`*^9, 3.731957602730181*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"eDot1", "=", 
  RowBox[{"eDot", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", " ", 
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "0"}], "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "S"], "^", "2"}], " ", "/", " ", 
       RowBox[{"a", "^", "2"}]}]}], ")"}], "\[Rule]", " ", 
    "\[Chi]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"\[Omega]Dot1", "=", 
  RowBox[{"\[Omega]Dot", "/.", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"n", " ", 
      RowBox[{"J", "[", 
       RowBox[{"2", ",", "0"}], "]"}], 
      RowBox[{
       RowBox[{
        SubscriptBox["r", "S"], "^", "2"}], " ", "/", " ", 
       RowBox[{"a", "^", "2"}]}]}], ")"}], "\[Rule]", " ", 
    "\[Chi]"}]}]}]}], "Input",
 CellChangeTimes->{{3.7319577001676035`*^9, 3.7319577103858185`*^9}, {
  3.731957748348322*^9, 3.7319578228389697`*^9}, {3.731957856080536*^9, 
  3.731957922680791*^9}, {3.7319644636682262`*^9, 3.7319644705064993`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Omega]"}], "]"}]}], 
  RowBox[{"8", " ", "n"}]]], "Output",
 CellChangeTimes->{3.7319578740492983`*^9, 3.7319579237927575`*^9, 
  3.7319583639894915`*^9, 3.731964471239575*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Chi]", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["9", "8"]}], "-", 
     RowBox[{
      FractionBox["15", "8"], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}]}], "+", 
  FractionBox[
   RowBox[{"9", "-", 
    RowBox[{"15", " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "i"}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"15", "-", 
       RowBox[{"15", " ", 
        RowBox[{"Cos", "[", 
         RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], " ", 
     RowBox[{"Cos", "[", 
      RowBox[{"2", " ", "\[Omega]"}], "]"}]}]}], 
   RowBox[{"16", " ", "n"}]]}]], "Output",
 CellChangeTimes->{3.7319578740492983`*^9, 3.7319579237927575`*^9, 
  3.7319583639894915`*^9, 3.731964471247862*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"TrigExpand", "[", "\[Omega]Dot1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7319645926798763`*^9, 3.7319646196108613`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      RowBox[{"12", " ", "n", " ", "\[Chi]"}], "+", 
      RowBox[{"10", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "n", " ", "\[Chi]"}]}], ")"}], " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "i"}], "-", 
         RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "-", 
      RowBox[{"10", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Omega]"}], "]"}]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{"i", "+", "\[Omega]"}], ")"}]}], "]"}]}]}], ")"}]}], 
   RowBox[{"32", " ", "n"}]]}]], "Output",
 CellChangeTimes->{{3.7319646059862623`*^9, 3.7319646200194283`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eDot2", "=", 
     RowBox[{"eDot1", "/.", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"5", " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], "/", "8"}], "\[Rule]", 
       " ", "\[Alpha]"}]}]}], "\[IndentingNewLine]", 
    RowBox[{"\[Omega]Dot1", "=", 
     RowBox[{
      RowBox[{"TrigReduce", "[", "\[Omega]Dot1", "]"}], "/.", 
      RowBox[{"TrigExpand", "[", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox["9", "8"]}], "-", 
          RowBox[{
           FractionBox["15", "8"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2", " ", "i"}], "]"}]}]}], ")"}], "("}]}]}]}]}], "]"}], 
  "\[Rule]", " ", "\[Alpha]"}]], "Input",
 CellChangeTimes->{{3.7319579608668833`*^9, 3.7319579617769413`*^9}, {
  3.731958004701168*^9, 3.731958046486692*^9}, {3.7319581228334265`*^9, 
  3.7319581405880823`*^9}, {3.7319582044519176`*^9, 3.7319582348747053`*^9}, {
  3.7319645852422543`*^9, 3.7319645859570284`*^9}, {3.7319646440657654`*^9, 
  3.7319646477289696`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"15", " ", "e", " ", 
   SuperscriptBox[
    RowBox[{"Sin", "[", "i", "]"}], "2"], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{"2", " ", "\[Omega]"}], "]"}]}], 
  RowBox[{"8", " ", "n"}]]], "Output",
 CellChangeTimes->{{3.7319580273355827`*^9, 3.731958047322447*^9}, {
   3.731958127739123*^9, 3.731958142601967*^9}, {3.7319582212508497`*^9, 
   3.7319582358200307`*^9}, 3.731958364023063*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"3", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "6"}], "+", 
      RowBox[{"12", " ", "n", " ", "\[Chi]"}], "-", 
      RowBox[{"10", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}]}], "+", 
      RowBox[{"20", " ", "n", " ", "\[Chi]", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "i"}], "]"}]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "i"}], "-", 
         RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}], "-", 
      RowBox[{"10", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"2", " ", "\[Omega]"}], "]"}]}], "+", 
      RowBox[{"5", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "i"}], "+", 
         RowBox[{"2", " ", "\[Omega]"}]}], "]"}]}]}], ")"}]}], 
   RowBox[{"32", " ", "n"}]]}]], "Output",
 CellChangeTimes->{{3.7319580273355827`*^9, 3.731958047322447*^9}, {
   3.731958127739123*^9, 3.731958142601967*^9}, {3.7319582212508497`*^9, 
   3.7319582358200307`*^9}, 3.7319583640340905`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7319575619734454`*^9, 3.7319575811635036`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Performance Analysis", "Section",
 CellChangeTimes->{{3.731941701295221*^9, 3.731941706869996*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalTime", " ", "=", " ", 
  RowBox[{
   RowBox[{"AbsoluteTime", "[", "]"}], "-", "t0"}]}]], "Input",
 CellChangeTimes->{{3.7318906854001236`*^9, 3.731890696824995*^9}}],

Cell[BoxData["142.5059482`9.605377985675755"], "Output",
 CellChangeTimes->{3.73189149993149*^9, 3.731891607655975*^9, 
  3.731891861526457*^9, 3.7319280173765407`*^9, 3.7319384961669855`*^9, 
  3.731941078942975*^9, 3.7319411491874185`*^9, 3.7319412138268614`*^9, 
  3.7319412905760107`*^9, 3.731941411230958*^9, 3.7319415141533175`*^9, 
  3.7319441786179695`*^9, 3.7319443567992234`*^9, 3.731947262917012*^9, 
  3.731947389862946*^9, 3.7319479998391895`*^9, 3.731948834446579*^9, 
  3.7319490300668974`*^9, 3.7319493494325294`*^9, 3.731952156586666*^9, 
  3.7319530371434293`*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 781},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 106, 1, 63, "Section"],
Cell[689, 25, 251, 5, 30, "Text"],
Cell[943, 32, 120, 2, 30, "Input"],
Cell[1066, 36, 171, 3, 30, "Input"],
Cell[CellGroupData[{
Cell[1262, 43, 690, 14, 30, "Input"],
Cell[1955, 59, 4078, 61, 30, "Output"]
}, Open  ]],
Cell[6048, 123, 103, 3, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6188, 131, 114, 1, 63, "Section"],
Cell[6305, 134, 133, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[6463, 139, 453, 13, 30, "Input"],
Cell[6919, 154, 493, 12, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7449, 171, 427, 9, 30, "Input"],
Cell[7879, 182, 856, 24, 51, "Output"]
}, Open  ]],
Cell[8750, 209, 136, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[8911, 214, 401, 10, 30, "Input"],
Cell[9315, 226, 413, 9, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9765, 240, 859, 20, 30, "Input"],
Cell[10627, 262, 607, 16, 45, "Output"]
}, Open  ]],
Cell[11249, 281, 164, 2, 30, "Text"],
Cell[11416, 285, 782, 23, 69, "Input"],
Cell[CellGroupData[{
Cell[12223, 312, 301, 6, 50, "Input"],
Cell[12527, 320, 2796, 73, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15360, 398, 192, 4, 30, "Input"],
Cell[15555, 404, 3752, 109, 93, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19344, 518, 192, 4, 30, "Input"],
Cell[19539, 524, 3071, 91, 80, "Output"]
}, Open  ]],
Cell[22625, 618, 180, 2, 30, "Text"],
Cell[22808, 622, 835, 13, 30, "Input"],
Cell[23646, 637, 245, 5, 30, "Input"],
Cell[23894, 644, 470, 12, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[24401, 661, 198, 2, 63, "Section"],
Cell[24602, 665, 527, 13, 52, "Text"],
Cell[25132, 680, 407, 7, 49, "Text"],
Cell[25542, 689, 1252, 29, 70, "Input"],
Cell[26797, 720, 111, 1, 30, "Text"],
Cell[26911, 723, 975, 24, 34, "Input"],
Cell[27889, 749, 402, 10, 30, "Text"],
Cell[CellGroupData[{
Cell[28316, 763, 1640, 29, 30, "Input"],
Cell[29959, 794, 3646, 55, 45, "Output"]
}, Open  ]],
Cell[33620, 852, 228, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[33873, 859, 1939, 48, 36, "Input"],
Cell[35815, 909, 3667, 74, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[39509, 987, 270, 3, 63, "Section"],
Cell[CellGroupData[{
Cell[39804, 994, 141, 1, 40, "Section"],
Cell[39948, 997, 620, 10, 49, "Text"],
Cell[40571, 1009, 229, 5, 30, "Text"],
Cell[40803, 1016, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[40936, 1021, 613, 14, 30, "Input"],
Cell[41552, 1037, 2309, 51, 52, "Output"]
}, Open  ]],
Cell[43876, 1091, 260, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[44161, 1100, 922, 18, 30, "Input"],
Cell[45086, 1120, 2842, 63, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[47977, 1189, 193, 2, 54, "Section"],
Cell[48173, 1193, 187, 2, 30, "Text"],
Cell[48363, 1197, 108, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[48496, 1202, 1699, 34, 30, "Input"],
Cell[50198, 1238, 1823, 51, 45, "Output"]
}, Open  ]],
Cell[52036, 1292, 101, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[52162, 1297, 343, 6, 30, "Input"],
Cell[52508, 1305, 1810, 43, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54355, 1353, 2188, 48, 50, "Input"],
Cell[56546, 1403, 2108, 50, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58691, 1458, 721, 19, 58, "Input"],
Cell[59415, 1479, 1790, 41, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61242, 1525, 976, 24, 30, "Input"],
Cell[62221, 1551, 4839, 135, 88, "Output"]
}, Open  ]],
Cell[67075, 1689, 183, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[67283, 1697, 1005, 25, 30, "Input"],
Cell[68291, 1724, 1385, 32, 45, "Output"]
}, Open  ]],
Cell[69691, 1759, 213, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[69929, 1767, 713, 19, 30, "Input"],
Cell[70645, 1788, 1024, 27, 45, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[71718, 1821, 160, 2, 63, "Section"],
Cell[71881, 1825, 399, 6, 30, "Text"],
Cell[72283, 1833, 184, 2, 30, "Text"],
Cell[72470, 1837, 119, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[72614, 1842, 1432, 40, 69, "Input"],
Cell[74049, 1884, 579, 12, 30, "Output"],
Cell[74631, 1898, 1222, 32, 59, "Output"],
Cell[75856, 1932, 1222, 32, 59, "Output"]
}, Open  ]],
Cell[77093, 1967, 1739, 44, 88, "Input"],
Cell[CellGroupData[{
Cell[78857, 2015, 1224, 34, 126, "Input"],
Cell[80084, 2051, 2305, 70, 121, "Output"]
}, Open  ]],
Cell[82404, 2124, 2008, 53, 145, "Input"],
Cell[84415, 2179, 135, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[84575, 2184, 825, 21, 88, "Input"],
Cell[85403, 2207, 1062, 33, 52, "Output"]
}, Open  ]],
Cell[86480, 2243, 122, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[86627, 2248, 778, 21, 69, "Input"],
Cell[87408, 2271, 570, 19, 52, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[88027, 2296, 216, 3, 63, "Section"],
Cell[88246, 2301, 275, 6, 30, "Input"],
Cell[CellGroupData[{
Cell[88546, 2311, 595, 14, 30, "Input"],
Cell[89144, 2327, 745, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[89926, 2342, 1074, 30, 30, "Input"],
Cell[91003, 2374, 1019, 20, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92059, 2399, 944, 27, 32, "Input"],
Cell[93006, 2428, 2103, 56, 102, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95146, 2489, 782, 19, 32, "Input"],
Cell[95931, 2510, 1791, 46, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97759, 2561, 1110, 32, 50, "Input"],
Cell[98872, 2595, 1093, 23, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100002, 2623, 1024, 29, 30, "Input"],
Cell[101029, 2654, 2210, 60, 49, "Output"]
}, Open  ]],
Cell[103254, 2717, 166, 3, 30, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[103457, 2725, 208, 3, 54, "Section"],
Cell[103668, 2730, 143, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[103836, 2735, 456, 11, 30, "Input"],
Cell[104295, 2748, 333, 5, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104665, 2758, 306, 9, 30, "Input"],
Cell[104974, 2769, 911, 23, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105922, 2797, 427, 13, 36, "Input"],
Cell[106352, 2812, 1400, 40, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107789, 2857, 350, 10, 36, "Input"],
Cell[108142, 2869, 1276, 33, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109455, 2907, 263, 7, 30, "Input"],
Cell[109721, 2916, 472, 10, 30, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[110230, 2931, 585, 16, 34, "Input"],
Cell[110818, 2949, 1229, 33, 50, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[112096, 2988, 109, 1, 63, "Section"],
Cell[112208, 2991, 315, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[112548, 3001, 254, 6, 30, "Input"],
Cell[112805, 3009, 353, 9, 49, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113195, 3023, 1129, 30, 34, "Input"],
Cell[114327, 3055, 2317, 75, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116681, 3135, 1067, 36, 30, "Input"],
Cell[117751, 3173, 896, 30, 54, "Output"]
}, Open  ]],
Cell[118662, 3206, 157, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[118844, 3212, 961, 27, 50, "Input"],
Cell[119808, 3241, 352, 9, 49, "Output"],
Cell[120163, 3252, 811, 26, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[121011, 3283, 179, 3, 30, "Input"],
Cell[121193, 3288, 961, 28, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122191, 3321, 1189, 32, 68, "Input"],
Cell[123383, 3355, 429, 10, 49, "Output"],
Cell[123815, 3367, 1101, 30, 47, "Output"]
}, Open  ]],
Cell[124931, 3400, 96, 1, 30, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[125064, 3406, 105, 1, 63, "Section"],
Cell[CellGroupData[{
Cell[125194, 3411, 194, 4, 30, "Input"],
Cell[125391, 3417, 582, 8, 30, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

